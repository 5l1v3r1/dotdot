{"version":3,"sources":["sections/Chat/index.module.scss","sections/Chat/OnlineUsers/index.module.scss","sections/Login/index.module.scss","store/reducer.ts","store/state.tsx","constants.ts","util/socketProvider.tsx","components/Logo/index.tsx","components/Loader/index.tsx","sections/Chat/Messages/Message/index.tsx","sections/Chat/Messages/index.tsx","sections/Chat/TextBox/index.tsx","sections/Chat/OnlineUsers/index.tsx","util/fetch.ts","sections/Chat/PasswordLock/index.tsx","sections/Chat/index.tsx","sections/loading/index.tsx","util/AuthenticatedRoute.tsx","util/UnauthenticatedRoute.tsx","components/OfflineCheck/index.tsx","sections/Login/index.tsx","util/checkAuth.ts","router.tsx","components/Title/index.tsx","lib/icons.ts","index.tsx","sections/Chat/Messages/Message/index.module.scss","components/Logo/index.module.scss","sections/Chat/PasswordLock/index.module.scss","sections/Chat/Messages/index.module.scss","components/OfflineCheck/index.module.scss"],"names":["module","exports","produce","draft","action","console","log","type","offline","auth","checked","error","payload","loggedIn","user","token","socket","connected","hasPassword","initialState","key","StateContext","React","createContext","state","dispatch","warn","StateProvider","props","useReducer","reducer","value","Provider","children","useGlobalState","useContext","API_URL","process","SocketContext","useState","setSocket","useEffect","newSocket","socketio","reconnection","timeout","query","on","provider","style","infinite","animationIterationCount","animationDirection","className","styles","logo","blob","svgFilter","xmlns","version","id","in","stdDeviation","result","mode","values","in2","Logo","userColor","message","color","classNames","attributes","private","privateDraft","header","timestamp","op","user_id","name","body","useImmer","messages","setState","chatAreaRef","useRef","current","scrollTop","scrollHeight","existingDraft","findIndex","eachMessage","splice","lastMessage","length","push","ref","Container","messageList","map","Message","draftTimer","Form","noValidate","onSubmit","e","preventDefault","trim","emit","textBox","Group","controlId","Control","as","placeholder","autoFocus","onChange","clearTimeout","currentTarget","setTimeout","users","onlineUsers","OverlayTrigger","placement","overlay","Tooltip","csrfToken","axios","defaults","withCredentials","fetchResource","path","method","a","Error","url","options","data","xsrfHeaderName","headers","response","status","parseAxiosError","errors","parseErrorList","join","defaultError","i","Array","isArray","parseErrors","useFetch","showModal","setShowModal","validated","setValidated","password","setPassword","repeatPassword","setRepeatPassword","handleClose","buttonClass","unlocked","buttonIcon","tooltipText","title","locked","passwordLock","delay","Button","variant","onClick","icon","Modal","show","onHide","event","stopPropagation","checkValidity","then","catch","reason","Header","closeButton","Title","Body","required","minLength","Feedback","pattern","Footer","chatArea","Loader","chat","Row","Col","PasswordLock","OnlineUsers","Messages","TextBox","exact","component","to","String","username","loading","localState","login","disabled","visibility","checkAuth","OfflineCheck","UnauthenticatedRoute","Login","AuthenticatedRoute","Chat","windowFocused","setWindowFocused","titleNotification","setTitleNotification","onMessage","useCallback","window","onfocus","onblur","library","add","faLock","faLockOpen","app","basename","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.db5fb61b.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"chat\":\"Chat_chat__LEZtX\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"onlineUsers\":\"OnlineUsers_onlineUsers__2Umxk\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"login\":\"Login_login__38Hzs\"};","import produce from 'immer'\n\nimport { AppState, Action } from './types'\n\n// TODO NEW BLOG POST\n// const REDUCER = {\n//   [REDUX_CONSTANTS.LOGIN]: (draft, payload) => {},\n// };\n\nexport default produce((draft: AppState, action: Action) => {\n  // REDUCER[action.type](draft, action.payload);\n\n  console.log('REDUCER', action)\n\n  switch (action.type) {\n    case 'login':\n      if (!draft.offline) {\n        draft.auth.checked = true\n      }\n\n      draft.error = null\n\n      if (!action.payload) {\n        draft.auth.loggedIn = false\n        draft.auth.user = null\n        draft.auth.token = null\n        break\n      }\n\n      draft.offline = false\n\n      draft.auth.loggedIn = true\n      draft.auth.user = action.payload.user\n      draft.auth.token = action.payload.token\n      break\n    case 'offline':\n      draft.offline = true\n      draft.error = null\n      draft.auth.token = null\n      draft.socket.connected = false\n      break\n    case 'error':\n      draft.error = action.payload\n      break\n    case 'socketConnected':\n      draft.socket.connected = action.payload\n      if (!action.payload) {\n        draft.auth.token = null\n      }\n      break\n    case 'user_password':\n      if (draft.auth.user) {\n        draft.auth.user.hasPassword = true\n      }\n      break\n  }\n})\n","import React from 'react'\n\nimport reducer from './reducer'\nimport { AppState, AppContext, Action } from './types'\n\nconst initialState: AppState = {\n  auth: {\n    checked: false,\n    loggedIn: false,\n    user: null,\n    token: null,\n  },\n  socket: {\n    connected: false,\n    key: null,\n  },\n  offline: false,\n  error: null,\n}\nconst defaultDispatch: React.Dispatch<Action> = () => {\n  console.warn('Using default reducer, check StateProvider')\n  return initialState\n}\nexport const StateContext = React.createContext<AppContext>({\n  state: initialState,\n  dispatch: defaultDispatch,\n})\n\ntype Props = {\n  children: any\n}\n\nexport const StateProvider = (props: Props) => {\n  const [state, dispatch] = React.useReducer(reducer, initialState)\n  // TODO: if value is not \"any\" then typescript has an issue with readonly state values\n  const value: any = { state, dispatch }\n  return (\n    <StateContext.Provider value={value}>\n      {props.children}\n    </StateContext.Provider>\n  )\n}\n\nexport const useGlobalState = (): AppContext => React.useContext(StateContext)\nexport default useGlobalState\n","export const API_URL = process.env.REACT_APP_API_URL || 'https://api.dotdot.im'\n","import React, { createContext, useEffect, useState } from 'react'\nimport socketio from 'socket.io-client'\n\nimport { useGlobalState } from 'store/state'\nimport { API_URL } from '../constants'\n\ntype SocketContextType = {\n  socket: SocketIOClient.Socket | null\n}\n\nexport const SocketContext = createContext<SocketContextType>({\n  socket: null,\n})\n\ntype Props = {\n  children: any\n}\n\nexport default (props: Props) => {\n  const { state, dispatch } = useGlobalState()\n  const [socket, setSocket] = useState<SocketIOClient.Socket | null>(null)\n\n  useEffect(() => {\n    // clear any errors\n    dispatch({\n      type: 'error',\n      payload: null,\n    })\n\n    if (!state.auth.loggedIn || !state.auth.token) {\n      return\n    }\n\n    // initialize the socket\n    const newSocket = socketio(API_URL, {\n      reconnection: true,\n      timeout: 2000,\n      query: {\n        token: state.auth.token,\n      },\n    })\n\n    newSocket.on('connect', () => {\n      dispatch({\n        type: 'socketConnected',\n        payload: true,\n      })\n    })\n\n    newSocket.on('connect_error', (error: string) => {\n      dispatch({\n        type: 'offline',\n        payload: null,\n      })\n    })\n\n    newSocket.on('connect_timeout', (timeout: string) => {\n      dispatch({\n        type: 'offline',\n        payload: null,\n      })\n    })\n\n    newSocket.on('error', (error: string) => {\n      dispatch({\n        type: 'socketConnected',\n        payload: false,\n      })\n\n      if (error) {\n        dispatch({\n          type: 'error',\n          payload: error,\n        })\n      } else {\n        dispatch({\n          type: 'offline',\n          payload: null,\n        })\n      }\n    })\n\n    setSocket(newSocket)\n  }, [dispatch, state.auth.loggedIn, state.auth.token])\n\n  let provider = {\n    socket,\n  }\n\n  return (\n    <SocketContext.Provider value={provider}>\n      {props.children}\n    </SocketContext.Provider>\n  )\n}\n","import React from 'react'\n\nimport styles from './index.module.scss'\n\ntype Props = {\n  infinite?: boolean\n}\n\nexport default (props: Props) => {\n  const style: any = {}\n  if (props.infinite) {\n    style.animationIterationCount = 'infinite'\n    style.animationDirection = 'alternate'\n  }\n  return (\n    <>\n      <div className={styles.logo}>\n        <div className={styles.blob} style={style}></div>\n        <div className={styles.blob} style={style}></div>\n      </div>\n\n      <svg\n        className={styles.svgFilter}\n        xmlns=\"http://www.w3.org/2000/svg\"\n        version=\"1.1\"\n      >\n        <defs>\n          <filter id=\"goo\">\n            <feGaussianBlur\n              in=\"SourceGraphic\"\n              stdDeviation=\"10\"\n              result=\"blur\"\n            />\n            <feColorMatrix\n              in=\"blur\"\n              mode=\"matrix\"\n              values=\"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7\"\n              result=\"goo\"\n            />\n            <feBlend in=\"SourceGraphic\" in2=\"goo\" />\n          </filter>\n        </defs>\n      </svg>\n    </>\n  )\n}\n","import React from 'react'\nimport Logo from 'components/Logo'\n\ntype Props = {\n  text?: string | null\n}\n\nexport default (props: Props) => {\n  return (\n    <>\n      <Logo infinite />\n    </>\n  )\n}\n","import React from 'react'\nimport classNames from 'classnames'\nimport { Message } from 'store/types'\n\nimport styles from './index.module.scss'\nimport useGlobalState from 'store/state'\n\ntype Props = {\n  message: Message\n}\n\nexport default (props: Props) => {\n  const { state } = useGlobalState()\n\n  const userColor = `#${props.message.user.color}`\n\n  const style: any = {}\n\n  return (\n    <div\n      className={classNames(styles.message, {\n        [styles.draft]: props.message.attributes.draft,\n        [styles.private]: props.message.attributes.private,\n        [styles.privateDraft]:\n          props.message.attributes.private && props.message.attributes.draft,\n      })}\n      key={props.message.id}\n      style={style}\n    >\n      <div className={classNames(styles.header)} style={{ color: userColor }} />\n      <div className={classNames(styles.timestamp)}>\n        {props.message.attributes.draft ? 'typing...' : '12:34'}\n      </div>\n      <span\n        className={classNames(styles.user, {\n          [styles.op]: props.message.user.user_id === state.auth.user?.user_id,\n        })}\n      >\n        {props.message.user.name}\n      </span>\n      <div className={classNames(styles.body)}>{props.message.message}</div>\n    </div>\n  )\n}\n","import React, { useEffect, useContext, useRef } from 'react'\nimport { Container } from 'react-bootstrap'\nimport { useImmer } from 'use-immer'\nimport classNames from 'classnames'\n\nimport { SocketContext } from 'util/socketProvider'\nimport { Message } from 'store/types'\nimport MessageComponent from './Message'\n\nimport styles from './index.module.scss'\n\ntype State = {\n  messages: Message[]\n}\n\nexport default () => {\n  const [state, setState] = useImmer<State>({\n    messages: [],\n  })\n\n  const { socket } = useContext(SocketContext)\n\n  const chatAreaRef = useRef<HTMLDivElement>(null)\n\n  useEffect(() => {\n    if (!chatAreaRef || !chatAreaRef.current) {\n      return\n    }\n    chatAreaRef.current.scrollTop = chatAreaRef.current.scrollHeight\n  }, [state.messages])\n\n  useEffect(() => {\n    if (!socket) {\n      return\n    }\n    socket.on('message', (payload: Message) => {\n      // check if the last one was by the same user\n      setState((draft) => {\n        // delete draft from this user\n        // find previous drafts by this user\n        const existingDraft = draft.messages.findIndex(\n          (eachMessage) =>\n            eachMessage.attributes.draft &&\n            eachMessage.user.user_id === payload.user.user_id\n        )\n        if (existingDraft > -1) {\n          draft.messages.splice(existingDraft, 1)\n        }\n\n        // if the last message is by the same user, just append to it\n        const lastMessage = draft.messages[draft.messages.length - 1]\n        if (lastMessage && lastMessage.user.user_id === payload.user.user_id) {\n          lastMessage.message += `\\n${payload.message}`\n          return\n        }\n\n        draft.messages.push({\n          id: draft.messages.length,\n          attributes: payload.attributes,\n          message: payload.message,\n          user: payload.user,\n        })\n      })\n    })\n  }, [socket, setState])\n\n  return (\n    <div className={classNames(styles.messages, 'my-4')} ref={chatAreaRef}>\n      <Container>\n        <div className={classNames(styles.messageList)}>\n          {state.messages.map((eachMessage) => (\n            <MessageComponent key={eachMessage.id} message={eachMessage} />\n          ))}\n        </div>\n      </Container>\n    </div>\n  )\n}\n","import React, { useContext, useRef } from 'react'\nimport { Container } from 'react-bootstrap'\nimport { Form } from 'react-bootstrap'\nimport { useImmer } from 'use-immer'\n\nimport { SocketContext } from 'util/socketProvider'\nimport styles from './index.module.scss'\n\ntype State = {\n  message: string\n}\n\nexport default () => {\n  const [state, setState] = useImmer<State>({\n    message: '',\n  })\n  const draftTimer = useRef<any>(null)\n\n  const { socket } = useContext(SocketContext)\n\n  const handleSubmit = (e: React.ChangeEvent<any>) => {\n    e.preventDefault()\n\n    if (state.message.length < 1 || state.message.trim().length < 1) {\n      return\n    }\n\n    socket?.emit('message', {\n      message: state.message,\n    })\n\n    setState((draft) => {\n      draft.message = ''\n    })\n  }\n\n  const sendDraft = (message: string) => {\n    if (message.length < 1 || message.trim().length < 1) {\n      return\n    }\n    socket?.emit('draft', {\n      message,\n    })\n  }\n\n  const onType = (e: React.ChangeEvent<any>) => {\n    e.preventDefault()\n\n    clearTimeout(draftTimer.current)\n\n    const value = e.currentTarget.value\n    setState((draft) => {\n      draft.message = value\n    })\n\n    draftTimer.current = setTimeout(() => {\n      sendDraft(value)\n    }, 100)\n  }\n\n  return (\n    <Form noValidate onSubmit={handleSubmit} className={styles.textBox}>\n      <Form.Group controlId=\"chatForm.message\">\n        <Container>\n          <Form.Control\n            as=\"input\"\n            type=\"text\"\n            placeholder=\"Type a message...\"\n            autoFocus\n            onChange={onType}\n            value={state.message}\n          />\n        </Container>\n      </Form.Group>\n    </Form>\n  )\n}\n","import React, { useEffect, useContext } from 'react'\nimport { useImmer } from 'use-immer'\n\nimport { SocketContext } from 'util/socketProvider'\nimport { User } from 'store/types'\nimport { OverlayTrigger, Tooltip } from 'react-bootstrap'\n\nimport styles from './index.module.scss'\n\ntype State = {\n  users: User[]\n}\n\nexport default () => {\n  const [state, setState] = useImmer<State>({\n    users: [],\n  })\n\n  const { socket } = useContext(SocketContext)\n\n  useEffect(() => {\n    if (!socket) {\n      return\n    }\n    socket.on('users', (payload: any) => {\n      setState((draft) => {\n        draft.users = payload.users\n      })\n    })\n  }, [socket, setState])\n\n  return (\n    <div className={styles.onlineUsers}>\n      {state.users.map((user) => (\n        <OverlayTrigger\n          key={user.user_id}\n          placement=\"bottom\"\n          overlay={<Tooltip id={`user-${user.user_id}`}>@{user.name}</Tooltip>}\n        >\n          <span style={{ color: `#${user.color}` }}>&bull;</span>\n        </OverlayTrigger>\n      ))}\n    </div>\n  )\n}\n","import { useEffect, useState } from 'react'\nimport axios, { AxiosRequestConfig, AxiosError } from 'axios'\n\nimport { API_URL } from '../constants'\n\nexport type FetchMethod = 'GET' | 'POST' | 'PUT' | 'DELETE'\nexport const CSRF_HEADER = 'x-csrf-token'\nlet csrfToken = ''\n\nexport type FetchError = {\n  status: number\n  message: string\n  errors: string[]\n}\n\ntype FetchReturn<T> = [boolean, T | null, FetchError | null]\n\naxios.defaults.withCredentials = true\n\nfunction useFetch<T>(\n  path: string,\n  method: FetchMethod,\n  body?: any\n): FetchReturn<T> {\n  const [error, setError] = useState<FetchError | null>(null)\n  const [loading, setLoading] = useState<boolean>(true)\n  const [response, setResponse] = useState<T | null>(null)\n\n  useEffect(() => {\n    const sendRequest = async () => {\n      try {\n        const data = await fetchResource(path, method, body)\n        setResponse(data)\n      } catch (error) {\n        setError(error)\n      } finally {\n        setLoading(false)\n      }\n    }\n\n    sendRequest()\n  }, [path, method, body])\n\n  return [loading, response, error]\n}\n\nexport const fetchResource = async (\n  path: string,\n  method: FetchMethod,\n  body?: any\n) => {\n  if (!path) {\n    throw new Error(`'url' is required for fetching data`)\n  }\n\n  const url = `${API_URL}${path}`\n  const options: AxiosRequestConfig = {\n    url,\n    method,\n    data: body,\n    timeout: 6000,\n    withCredentials: true,\n    xsrfHeaderName: CSRF_HEADER,\n    headers: {},\n  }\n\n  if (csrfToken.length > 0) {\n    options.headers[CSRF_HEADER] = csrfToken\n  }\n\n  try {\n    const response = await axios(options)\n\n    if (response.headers[CSRF_HEADER]) {\n      csrfToken = response.headers[CSRF_HEADER]\n    }\n\n    return await response.data\n  } catch (error) {\n    if (error.response) {\n      console.warn(`useFetch error on ${method} ${path}`, error.response)\n      const returnError: FetchError = {\n        status: error.response.status,\n        message: parseAxiosError(error),\n        errors: parseErrorList(error),\n      }\n      throw returnError\n    }\n\n    console.warn(`useFetch network error on ${method} ${path}`, error)\n    const returnError: FetchError = {\n      status: 500,\n      message: error.message,\n      errors: [error.message],\n    }\n    throw returnError\n  }\n}\n\nfunction parseAxiosError(error: AxiosError): string {\n  if (!error.response || !error.response.data) {\n    return error.message || 'An error occurred'\n  }\n\n  return parseErrorList(error).join('. ')\n}\n\nfunction parseErrorList(error: AxiosError): string[] {\n  const defaultError = 'An error occurred'\n  if (!error.response || !error.response.data) {\n    return [error.message || defaultError]\n  }\n\n  return parseErrors(\n    defaultError,\n    error.response.data,\n    error.response.data.errors,\n    error.response.data.error\n  )\n}\n\nfunction parseErrors(defaultError: string, ...errors: any[]): string[] {\n  for (let i = 0; i < errors.length; i++) {\n    const error = errors[i]\n    if (Array.isArray(error)) return error\n    if (typeof error === 'string') return [error]\n  }\n\n  return [defaultError]\n}\n\nexport default useFetch\n","import React, { useState } from 'react'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { OverlayTrigger, Tooltip, Button, Modal, Form } from 'react-bootstrap'\n\nimport styles from './index.module.scss'\nimport { fetchResource } from 'util/fetch'\nimport useGlobalState from 'store/state'\nimport { IconProp } from '@fortawesome/fontawesome-svg-core'\n\nexport default () => {\n  const { state, dispatch } = useGlobalState()\n\n  const [showModal, setShowModal] = useState<boolean>(false)\n  const [validated, setValidated] = useState<boolean>(false)\n\n  const [password, setPassword] = useState<string>('')\n  const [repeatPassword, setRepeatPassword] = useState<string>('')\n\n  const handleClose = () => setShowModal(false)\n  const handleShow = () => setShowModal(true)\n\n  const handleSubmit = (event: React.ChangeEvent<HTMLFormElement>) => {\n    event.preventDefault()\n    event.stopPropagation()\n\n    const form = event.currentTarget\n\n    if (form.checkValidity() === false || password !== repeatPassword) {\n      return\n    }\n\n    setValidated(true)\n\n    const body = {\n      password,\n      repeatPassword,\n    }\n\n    fetchResource('/password', 'POST', body)\n      .then(() => {\n        dispatch({\n          type: 'user_password',\n          payload: true,\n        })\n      })\n      .catch((reason) => {\n        console.log('login fail reason', reason)\n        dispatch({\n          type: 'error',\n          payload: reason.errors.join(', '),\n        })\n      })\n  }\n\n  let buttonClass = styles.unlocked\n  let buttonIcon: IconProp = 'lock-open'\n  let tooltipText = 'Set a password to keep your username'\n  let title = 'Claim Username'\n\n  if (state.auth.user && state.auth.user.hasPassword) {\n    buttonClass = styles.locked\n    buttonIcon = 'lock'\n    tooltipText = 'Change your password'\n    title = 'Update Password'\n  }\n\n  return (\n    <div className={styles.passwordLock}>\n      <OverlayTrigger\n        placement=\"bottom\"\n        delay={500}\n        overlay={<Tooltip id=\"passwordLock\">{tooltipText}</Tooltip>}\n      >\n        <Button variant=\"link\" className={buttonClass} onClick={handleShow}>\n          <FontAwesomeIcon icon={buttonIcon} />\n        </Button>\n      </OverlayTrigger>\n\n      <Modal show={showModal} onHide={handleClose}>\n        <Form noValidate validated={validated} onSubmit={handleSubmit}>\n          <Modal.Header closeButton>\n            <Modal.Title>\n              { title }\n            </Modal.Title>\n          </Modal.Header>\n\n          <Modal.Body>\n            <Form.Group controlId=\"pwd.new\">\n              <Form.Control\n                as=\"input\"\n                type=\"password\"\n                placeholder=\"Password...\"\n                autoFocus\n                required\n                minLength={6}\n                onChange={(event) => {\n                  setPassword(event.currentTarget.value)\n                }}\n                value={password}\n              />\n              <Form.Control.Feedback type=\"invalid\">\n                The password is too short. Minimum length is 6 characters.\n              </Form.Control.Feedback>\n            </Form.Group>\n\n            <Form.Group controlId=\"pwd.new\">\n              <Form.Control\n                as=\"input\"\n                type=\"password\"\n                placeholder=\"Repeat Password...\"\n                required\n                minLength={6}\n                pattern={password}\n                onChange={(event) => {\n                  setRepeatPassword(event.currentTarget.value)\n                }}\n                value={repeatPassword}\n              />\n              <Form.Control.Feedback type=\"invalid\">\n                The passwords don't match!\n              </Form.Control.Feedback>\n            </Form.Group>\n          </Modal.Body>\n          <Modal.Footer>\n            <Button variant=\"secondary\" onClick={handleClose}>\n              Close\n            </Button>\n            <Button type=\"submit\" variant=\"primary\">\n              Set password\n            </Button>\n          </Modal.Footer>\n        </Form>\n      </Modal>\n    </div>\n  )\n}\n","import React from 'react'\nimport { Container, Row, Col } from 'react-bootstrap'\n\nimport { useGlobalState } from 'store/state'\nimport Loader from 'components/Loader'\n\nimport styles from './index.module.scss'\nimport Messages from './Messages'\nimport TextBox from './TextBox'\nimport OnlineUsers from './OnlineUsers'\nimport PasswordLock from './PasswordLock'\n\nexport default () => {\n  const { state } = useGlobalState()\n\n  let chatArea = <Loader />\n\n  if (state.socket.connected) {\n    chatArea = (\n      <>\n        <div className={styles.chat}>\n          <Container>\n            <Row>\n              <Col>\n                <PasswordLock />\n              </Col>\n              <Col>\n                <OnlineUsers />\n              </Col>\n            </Row>\n          </Container>\n\n          <Messages />\n          <TextBox />\n        </div>\n      </>\n    )\n  }\n\n  return chatArea\n}\n","import React from 'react'\n\nimport Loader from 'components/Loader'\n\nexport default () => {\n  return (\n    <>\n      <Loader />\n    </>\n  )\n}\n","import React from 'react'\nimport { Route, Redirect } from 'react-router-dom'\nimport { useGlobalState } from 'store/state'\n\nimport Loading from 'sections/loading'\n\ntype Props = {\n  path: string\n  exact?: boolean\n  component?: React.ComponentType<any>\n}\n\n/**\n * This Route only allows browsing into if the user IS logged in\n */\nexport default (props: Props) => {\n  const { state } = useGlobalState()\n  if (!state.auth.checked) {\n    return <Loading />\n  }\n\n  if (!state.auth.loggedIn) {\n    return <Redirect to=\"/login\" />\n  }\n\n  return (\n    <Route path={props.path} exact={props.exact} component={props.component} />\n  )\n}\n","import React from 'react'\nimport { Route, Redirect } from 'react-router-dom'\nimport { useGlobalState } from 'store/state'\n\nimport Loading from 'sections/loading'\n\ntype Props = {\n  path: string\n  exact?: boolean\n  component?: React.ComponentType<any>\n}\n\n/**\n * This Route only allows browsing into if the user is NOT logged in\n */\nexport default (props: Props) => {\n  const { state } = useGlobalState()\n  if (!state.auth.checked) {\n    return <Loading />\n  }\n\n  if (state.auth.loggedIn) {\n    return <Redirect to=\"/\" />\n  }\n\n  return (\n    <Route path={props.path} exact={props.exact} component={props.component} />\n  )\n}\n","import React from 'react'\n\nimport { useGlobalState } from 'store/state'\nimport styles from './index.module.scss'\n\nexport default () => {\n  const { state } = useGlobalState()\n\n  if (!state.offline && !state.error) {\n    return null\n  }\n\n  let error = state.error\n  if (Array.isArray(error)) {\n    error = error.join('. ')\n  }\n  if (typeof error !== 'string') {\n    error = String(error)\n  }\n\n  if (state.error) {\n    return <div className={styles.offline}>Error: {error}</div>\n  }\n\n  return (\n    <div className={styles.offline}>\n      You seem to be offline! Please try again later\n    </div>\n  )\n}\n","import React from 'react'\nimport { Form, Container } from 'react-bootstrap'\nimport { useImmer } from 'use-immer'\nimport classNames from 'classnames'\n\nimport { useGlobalState } from 'store/state'\nimport { fetchResource } from 'util/fetch'\nimport Logo from 'components/Logo'\n\nimport styles from './index.module.scss'\nimport { AuthData } from 'store/types'\n\ntype State = {\n  username: string\n  password: string\n  hasPassword: boolean\n  loading: boolean\n}\n\nexport default () => {\n  const { dispatch } = useGlobalState()\n  const [localState, setState] = useImmer<State>({\n    username: '',\n    password: '',\n    hasPassword: false,\n    loading: false,\n  })\n\n  const handleSubmit = (e: React.ChangeEvent<any>) => {\n    e.preventDefault()\n\n    console.log('login')\n\n    if (localState.loading) {\n      return\n    }\n\n    setState((draft) => {\n      draft.loading = true\n    })\n\n    const body = {\n      username: localState.username,\n      password: localState.password,\n    }\n    fetchResource('/auth', 'POST', body)\n      .then((data: AuthData) => {\n        if (!data || !data.user.user_id) {\n          console.warn('Invalid user object')\n          dispatch({\n            type: 'login',\n            payload: data,\n          })\n          return\n        }\n\n        dispatch({\n          type: 'login',\n          payload: data,\n        })\n      })\n      .catch((reason) => {\n        console.log('login fail reason', reason)\n        if (reason.status !== 400) {\n          // username requires password\n          dispatch({\n            type: 'error',\n            payload: reason.errors.join(', '),\n          })\n        }\n\n        setState((draft) => {\n          draft.loading = false\n          if (reason.status === 400) {\n            draft.hasPassword = true\n          }\n        })\n      })\n  }\n\n  return (\n    <Container className={classNames(styles.login, 'mt-4')}>\n      <Logo />\n      <Form noValidate onSubmit={handleSubmit}>\n        <Form.Group controlId=\"loginForm.username\">\n          <Form.Control\n            as=\"input\"\n            type=\"text\"\n            placeholder=\"What's your name?\"\n            disabled={localState.loading}\n            autoFocus\n            onChange={(e) => {\n              const value = e.currentTarget.value\n              setState((draft) => {\n                draft.username = value\n              })\n            }}\n            value={localState.username}\n          />\n          {localState.hasPassword && (\n            <Form.Control\n              as=\"input\"\n              className=\"mt-2\"\n              type=\"password\"\n              placeholder=\"Password...\"\n              disabled={localState.loading}\n              autoFocus\n              onChange={(e) => {\n                const value = e.currentTarget.value\n                setState((draft) => {\n                  draft.password = value\n                })\n              }}\n              value={localState.password}\n            />\n          )}\n          <button type=\"submit\" style={{ visibility: 'hidden' }}>\n            Login\n          </button>\n        </Form.Group>\n      </Form>\n    </Container>\n  )\n}\n","import { Action, AuthData } from 'store/types'\n\nimport { fetchResource } from './fetch'\n\nconst OFFLINE_RETRY_DELAY = 2000\n\nexport const checkAuth = (dispatch: React.Dispatch<Action>) => {\n  fetchResource('/auth', 'GET')\n    .then((data: AuthData) => {\n      if (!data || !data.user.user_id) {\n        console.warn('Invalid user object')\n        dispatch({\n          type: 'login',\n          payload: null,\n        })\n        return\n      }\n\n      dispatch({\n        type: 'login',\n        payload: data,\n      })\n    })\n    .catch((reason) => {\n      console.log('Login check failed', reason)\n      if (reason.message === 'Network Error') {\n        dispatch({\n          type: 'offline',\n          payload: null,\n        })\n\n        // try again\n        setTimeout(() => {\n          checkAuth(dispatch)\n        }, OFFLINE_RETRY_DELAY)\n      } else {\n        dispatch({\n          type: 'error',\n          payload: reason.errors.join(', '),\n        })\n\n        dispatch({\n          type: 'login',\n          payload: null,\n        })\n      }\n    })\n}\n\nexport default checkAuth\n","import React, { useEffect } from 'react'\nimport { Switch } from 'react-router-dom'\n\nimport Chat from 'sections/Chat'\nimport AuthenticatedRoute from 'util/AuthenticatedRoute'\nimport UnauthenticatedRoute from 'util/UnauthenticatedRoute'\nimport OfflineCheck from 'components/OfflineCheck'\nimport Login from 'sections/Login'\nimport useGlobalState from 'store/state'\nimport checkAuth from 'util/checkAuth'\n\nexport default () => {\n  const { state, dispatch } = useGlobalState()\n\n  // Check authentication state\n  useEffect(() => {\n    if (!state.auth.checked || !state.auth.token) {\n      checkAuth(dispatch)\n    }\n  }, [state.auth.checked, state.auth.token, dispatch])\n\n  return (\n    <>\n      <OfflineCheck />\n      <Switch>\n        <UnauthenticatedRoute path=\"/login\" component={Login} />\n        <AuthenticatedRoute path=\"/\" component={Chat} />\n      </Switch>\n    </>\n  )\n}\n","import React, { useEffect, useContext, useState, useCallback } from 'react'\nimport Helmet from 'react-helmet'\n\nimport { SocketContext } from 'util/socketProvider'\n\nexport default () => {\n  const { socket } = useContext(SocketContext)\n\n  const [windowFocused, setWindowFocused] = useState<boolean>(true)\n  const [titleNotification, setTitleNotification] = useState<boolean>(false)\n\n  const onMessage = useCallback(() => {\n    if (!windowFocused) {\n      setTitleNotification(true)\n    }\n  }, [windowFocused])\n\n  useEffect(() => {\n    if (!socket) {\n      return\n    }\n    socket.on('message', onMessage)\n  }, [socket, onMessage])\n\n  window.onfocus = function () {\n    setTitleNotification(false)\n    setWindowFocused(true)\n  }\n\n  window.onblur = function () {\n    setWindowFocused(false)\n  }\n\n  return (\n    <Helmet>\n      <title>{titleNotification ? '• dotdot' : 'dotdot'}</title>\n    </Helmet>\n  )\n}\n","import { library } from '@fortawesome/fontawesome-svg-core'\n\n/**\n * Icon Preloading\n * This is done so that only the icons that we need are loaded from FontAwesome\n */\n\n// Icons available in two styles, regular and solid\n// solid tends to have all free icons, while some regular ones are PRO only\nimport { faLock, faLockOpen } from '@fortawesome/free-solid-svg-icons'\n\n// import {\n\n// } from \"@fortawesome/free-regular-svg-icons\";\n\n/**\n * All icons that will be used in this app need to be preloaded here\n */\n\nexport default () => {\n  library.add(faLock, faLockOpen)\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { BrowserRouter } from 'react-router-dom'\n\nimport { StateProvider } from 'store/state'\nimport SocketProvider from 'util/socketProvider'\n\nimport loadIcons from './lib/icons'\nimport Router from './router'\nimport Title from './components/Title'\n\nimport 'assets/scss/index.scss'\n\nloadIcons()\n\nconst app = (\n  <BrowserRouter basename={process.env.REACT_APP_BASEPATH}>\n    <StateProvider>\n      <SocketProvider>\n        <Title />\n        <Router />\n      </SocketProvider>\n    </StateProvider>\n  </BrowserRouter>\n)\n\nReactDOM.render(app, document.getElementById('root'))\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"message\":\"Message_message__2v30T\",\"header\":\"Message_header__3wUCX\",\"user\":\"Message_user__3HofW\",\"timestamp\":\"Message_timestamp__2armv\",\"body\":\"Message_body__32TEj\",\"op\":\"Message_op__3lLYM\",\"draft\":\"Message_draft__1zB7h\",\"private\":\"Message_private__ORZ48\",\"privateDraft\":\"Message_privateDraft__YRrde\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"logo\":\"Logo_logo__30xDu\",\"svgFilter\":\"Logo_svgFilter__1s9i7\",\"blob\":\"Logo_blob__1iSwo\",\"blob-first\":\"Logo_blob-first__3YKrD\",\"blob-second\":\"Logo_blob-second__2r5Nx\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"passwordLock\":\"PasswordLock_passwordLock__2FTiA\",\"unlocked\":\"PasswordLock_unlocked__21MTQ\",\"pulse\":\"PasswordLock_pulse__2T-_F\",\"locked\":\"PasswordLock_locked__1mCl-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"messages\":\"Messages_messages__tCmp1\",\"messageList\":\"Messages_messageList__3cw_-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"offline\":\"OfflineCheck_offline__2vKbm\"};"],"sourceRoot":""}