{"version":3,"sources":["store/reducer.ts","store/state.tsx","constants.ts","util/socketProvider.tsx","components/Loader/index.tsx","sections/Chat/Messages/index.tsx","sections/Chat/TextBox/index.tsx","sections/Chat/index.tsx","sections/Loading/index.tsx","util/AuthenticatedRoute.tsx","util/UnauthenticatedRoute.tsx","components/OfflineCheck/index.tsx","util/fetch.ts","sections/Login/index.tsx","router.tsx","lib/icons.ts","index.tsx","components/OfflineCheck/index.module.scss"],"names":["produce","draft","action","console","info","type","log","payload","auth","checked","loggedIn","user","token","offline","error","connected","initialState","messages","users","StateContext","React","createContext","state","dispatch","warn","StateProvider","props","useReducer","reducer","value","Provider","children","useStateValue","useContext","API_URL","process","SocketContext","socket","useState","setSocket","useEffect","newSocket","socketio","reconnection","timeout","query","on","provider","icon","pulse","text","useImmer","drafts","setState","push","id","length","message","uuid","ListGroup","className","map","eachMessage","Item","key","style","borderLeftWidth","borderLeftColor","color","name","Object","values","draftTimer","useRef","Form","noValidate","onSubmit","e","preventDefault","emit","Group","controlId","Label","Control","as","autoFocus","onChange","clearTimeout","current","currentTarget","setTimeout","chatArea","Loader","Messages","TextBox","Container","Row","Col","md","span","offset","path","exact","component","to","Loading","styles","csrfToken","axios","defaults","withCredentials","fetchResource","method","body","a","Error","url","options","data","xsrfHeaderName","headers","response","status","errors","join","username","localState","then","catch","reason","OfflineCheck","UnauthenticatedRoute","Login","AuthenticatedRoute","Chat","faGoogleFix","faGoogle","faGithubFix","faGithub","library","add","faCoins","faCreditCard","faAt","faColumns","faCog","faArrowDown","faArrowUp","faSignOutAlt","faSignInAlt","faSave","faQuestionCircle","faSmile","faHeart","faAngleRight","faSpinner","faPlus","faTrash","faExclamationTriangle","loadIcons","app","basename","titleTemplate","ReactDOM","render","document","getElementById","module","exports"],"mappings":"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","file":"static/js/main.c432ee03.chunk.js","sourcesContent":["import produce from \"immer\"\n\nimport { AppState, Action } from \"./types\";\n\nexport default produce((draft: AppState, action: Action) => {\n  console.info('REDUCER: ', action.type);\n  console.log(action.payload);\n  switch (action.type) {\n    case 'login':\n      draft.auth.checked = true;\n\n      if (!action.payload) {\n        draft.auth.loggedIn = false;\n        draft.auth.user = null;\n        draft.auth.token = null;\n        break;\n      }\n\n      draft.auth.loggedIn = true;\n      draft.auth.user = action.payload.user;\n      draft.auth.token = action.payload.token;\n      break;\n    case 'offline':\n      draft.offline = true;\n      draft.error = null;\n      break;\n    case 'error':\n      draft.error = action.payload;\n      break;\n    case 'socketConnected':\n      draft.connected = action.payload;\n      break;\n  }\n});","import React from 'react';\n\nimport reducer from './reducer';\nimport { AppState, AppContext, Action } from './types';\n\nconst initialState: AppState = {\n  auth: {\n    checked: true,\n    loggedIn: false,\n    user: null,\n    token: null,\n  },\n  offline: false,\n  connected: false,\n  error: null,\n  messages: [],\n  users: [],\n};\nconst defaultDispatch: React.Dispatch<Action> = () => {\n  console.warn('Using default reducer, check StateProvider');\n  return initialState;\n}\nexport const StateContext = React.createContext<AppContext>({\n  state: initialState,\n  dispatch: defaultDispatch,\n});\n\ntype Props = {\n  children: any,\n};\n\nexport const StateProvider = (props: Props) =>{\n  const [state, dispatch] = React.useReducer(reducer, initialState);\n  // TODO: if value is not \"any\" then typescript has an issue with readonly state values\n  const value: any = { state, dispatch };\n  return (\n    <StateContext.Provider value={ value }>\n      { props.children }\n    </StateContext.Provider>\n  );\n};\n\nexport const useStateValue = (): AppContext => React.useContext(StateContext);\nexport default useStateValue;","export const API_URL = process.env.REACT_APP_API_URL || 'https://api.dotdot.im';","import React, { createContext, useEffect, useState } from \"react\";\nimport socketio from 'socket.io-client';\n\nimport { useStateValue } from \"store/state\";\nimport { API_URL } from \"../constants\";\n\ntype SocketContextType = {\n  socket: SocketIOClient.Socket | null,\n};\n\nexport const SocketContext = createContext<SocketContextType>({\n  socket: null,\n});\n\ntype Props = {\n  children: any,\n};\n\nexport default (props: Props) => {\n  const { state, dispatch } = useStateValue();\n  const [ socket, setSocket ] = useState<SocketIOClient.Socket | null>(null);\n\n  useEffect(() => {\n    // clear any errors\n    dispatch({\n      type: 'error',\n      payload: null,\n    });\n\n    if (!state.auth.loggedIn) {\n      return;\n    }\n\n    // initialize the socket\n    const newSocket = socketio(API_URL, {\n      reconnection: true,\n      timeout: 2000,\n      query: {\n          token: state.auth.token,\n      }\n    });\n\n    newSocket.on('connect', () => {\n      console.log('connected');\n\n      dispatch({\n        type: 'socketConnected',\n        payload: true,\n      });\n    });\n\n    newSocket.on('connect_error', (error: string) => {\n      console.log('failed to connect', error);\n\n      dispatch({\n        type: 'offline',\n        payload: null,\n      });\n    });\n\n    newSocket.on('connect_timeout', (timeout: string) => {\n      console.log('timeout connect', timeout);\n\n      dispatch({\n        type: 'offline',\n        payload: null,\n      });\n    });\n\n    newSocket.on('error', (error: string) => {\n      console.log('failed to connect', error);\n\n      dispatch({\n        type: 'login',\n        payload: null,\n      });\n\n      dispatch({\n        type: 'socketConnected',\n        payload: false,\n      });\n\n      if (error) {\n        dispatch({\n          type: 'error',\n          payload: error,\n        });\n      } else {\n        dispatch({\n          type: 'offline',\n          payload: null,\n        });\n      }\n    });\n\n    setSocket(newSocket);\n  }, [dispatch, state.auth.loggedIn, state.auth.token]);\n\n  let provider = {\n    socket,\n  };\n\n  console.log('socket provider: ', socket);\n\n  return (\n    <SocketContext.Provider value={ provider }>\n      { props.children }\n    </SocketContext.Provider>\n  );\n};","import React from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\ntype Props = {\n  text?: string | null,\n};\n\nexport default (props: Props) => {\n  return (\n    <>\n      <FontAwesomeIcon icon='spinner' pulse /> { props.text || 'Loading' }\n    </>\n  );\n};","import React, { useEffect, useContext } from \"react\";\nimport { ListGroup } from \"react-bootstrap\";\nimport { useImmer } from \"use-immer\";\n\nimport { SocketContext } from \"util/socketProvider\";\nimport { Message } from \"store/types\";\n\ntype State = {\n  messages: Message[];\n  drafts: {\n    [key: string]: Message;\n  };\n};\n\nexport default () => {\n  const [state, setState] = useImmer<State>({\n    messages: [],\n    drafts: {}\n  });\n\n  const { socket } = useContext(SocketContext);\n\n  useEffect(() => {\n    if (!socket) {\n      return;\n    }\n    socket.on(\"message\", (payload: Message) => {\n      setState(draft => {\n        draft.messages.push({\n          id: draft.messages.length,\n          message: payload.message,\n          user: payload.user\n        });\n        // delete draft from this user\n        delete draft.drafts[payload.user.uuid];\n      });\n    });\n\n    socket.on(\"draft\", (payload: Message) => {\n      setState(draft => {\n        draft.drafts[payload.user.uuid] = payload;\n      });\n    });\n  }, [socket, setState]);\n\n  return (\n    <ListGroup className=\"my-4\">\n      {state.messages.map(eachMessage => (\n        <ListGroup.Item\n          className=\"d-flex justify-content-between align-items-center\"\n          key={eachMessage.id}\n          style={{\n            borderLeftWidth: \"4px\",\n            borderLeftColor: `#${eachMessage.user.color}`\n          }}\n        >\n          {eachMessage.message}\n          <span className=\"text-muted\">{eachMessage.user.name}</span>\n        </ListGroup.Item>\n      ))}\n      {Object.values(state.drafts).map(eachMessage => (\n        <ListGroup.Item\n          className=\"d-flex justify-content-between align-items-center\"\n          key={eachMessage.id}\n          style={{\n            color: \"#aaa\",\n            borderLeftWidth: \"4px\",\n            borderLeftColor: `#${eachMessage.user.color}`\n          }}\n        >\n          {eachMessage.message}\n          <span className=\"text-muted\">{eachMessage.user.name}</span>\n        </ListGroup.Item>\n      ))}\n    </ListGroup>\n  );\n};\n","import React, { useContext, useRef } from \"react\";\nimport { Form } from \"react-bootstrap\";\nimport { useImmer } from \"use-immer\";\n\nimport { SocketContext } from \"util/socketProvider\";\n\ntype State = {\n  message: string,\n};\n\nexport default () => {\n  const [state, setState] = useImmer<State>({\n    message: '',\n  });\n  const draftTimer = useRef<any>(null)\n\n  const { socket } = useContext(SocketContext);\n\n  const handleSubmit = (e: React.ChangeEvent<any>) => {\n    e.preventDefault();\n\n    socket?.emit('message', {\n      message: state.message,\n    });\n\n    setState(draft => {\n      draft.message = '';\n    });\n  };\n\n  const sendDraft = (message: string) => {\n    socket?.emit('draft', {\n      message,\n    });\n  };\n\n  const onType = (e: React.ChangeEvent<any>) => {\n    e.preventDefault();\n\n    clearTimeout(draftTimer.current);\n\n    const value = e.currentTarget.value;\n    setState(draft => {\n      draft.message = value;\n    });\n\n    draftTimer.current = setTimeout(() => {\n      sendDraft(value);\n    }, 100);\n  };\n\n  return (\n    <Form noValidate onSubmit={handleSubmit}>\n      <Form.Group controlId=\"chatForm.message\">\n        <Form.Label>Message</Form.Label>\n        <Form.Control\n          as=\"input\"\n          type=\"text\"\n          autoFocus\n          onChange={ onType }\n          value={ state.message }\n        />\n      </Form.Group>\n    </Form>\n  );\n};\n","import React from \"react\";\nimport { Container } from \"react-bootstrap\";\n\nimport { useStateValue } from \"store/state\";\nimport Loader from 'components/Loader';\n\nimport \"./index.scss\";\nimport Messages from\"./Messages\";\nimport TextBox from \"./TextBox\";\n\nexport default () => {\n  const { state } = useStateValue();\n\n  let chatArea = (\n    <Loader />\n  );\n\n  if (state.connected) {\n    chatArea = (\n      <>\n        <Messages />\n        <TextBox />\n      </>\n    );\n  }\n\n  return (\n    <Container>\n      { chatArea }\n    </Container>\n  );\n};\n","import React from \"react\";\nimport { Container, Row, Col } from \"react-bootstrap\";\n\nimport Loader from \"components/Loader\";\n\nexport default () => {\n  return (\n    <>\n      <header>\n        <div className=\"bg-angle\" />\n        <section>\n          <Container>\n            <Row>\n              <Col md={{ span: 6, offset: 3 }}>\n                <div className='text-center mt-5'>\n                  <h4 className='my-2' style={{ color: '#fff' }}>\n                    <Loader />\n                  </h4>\n                </div>\n              </Col>\n            </Row>\n          </Container>\n        </section>\n      </header>\n    </>\n  );\n};\n","import React from 'react';\nimport { Route, Redirect } from \"react-router-dom\";\nimport { useStateValue } from 'store/state';\n\nimport Loading from 'sections/Loading';\n\ntype Props = {\n  path: string,\n  exact?: boolean,\n  component?: React.ComponentType<any>,\n};\n\n/**\n * This Route only allows browsing into if the user IS logged in\n */\nexport default (props: Props) => {\n  const { state } = useStateValue();\n  if (!state.auth.checked) {\n    return (\n      <Loading />\n    );\n  }\n\n  if (!state.auth.loggedIn) {\n    return (\n      <Redirect to='/login' />\n    );\n  }\n\n  return (\n    <Route\n      path={ props.path }\n      exact={ props.exact }\n      component={ props.component }\n    />\n  );\n};","import React from 'react';\nimport { Route, Redirect } from \"react-router-dom\";\nimport { useStateValue } from 'store/state';\n\nimport Loading from 'sections/Loading';\n\ntype Props = {\n  path: string,\n  exact?: boolean,\n  component?: React.ComponentType<any>,\n};\n\n/**\n * This Route only allows browsing into if the user is NOT logged in\n */\nexport default (props: Props) => {\n  const { state } = useStateValue();\n  if (!state.auth.checked) {\n    return (\n      <Loading />\n    );\n  }\n\n  if (state.auth.loggedIn) {\n    return (\n      <Redirect to='/' />\n    );\n  }\n\n  return (\n    <Route\n      path={ props.path }\n      exact={ props.exact }\n      component={ props.component }\n    />\n  );\n};","import React from \"react\";\n\nimport { useStateValue } from \"store/state\";\nimport styles from './index.module.scss';\n\nexport default () => {\n  const { state } = useStateValue();\n\n  if (!state.offline && !state.error) {\n    return null;\n  }\n\n  if (state.error) {\n    return (\n      <div className={ styles.offline }>\n        Error: {state.error}\n      </div>\n    );\n  }\n\n  return (\n    <div className={ styles.offline }>\n      You seem to be offline! Please try again later\n    </div>\n  );\n};\n","import { useEffect, useState } from 'react';\nimport axios, { AxiosRequestConfig } from 'axios';\n\nimport { API_URL } from '../constants';\n\nexport type FetchMethod = 'GET' | 'POST' | 'PUT' | 'DELETE';\nexport const CSRF_HEADER = 'x-csrf-token';\nlet csrfToken = '';\n\nexport type FetchError = {\n  status: number,\n  message: string,\n  errors: string[],\n};\n\ntype FetchReturn<T> = [\n  boolean,\n  T | null,\n  FetchError | null,\n];\n\naxios.defaults.withCredentials = true;\n\nfunction useFetch<T>(path: string, method: FetchMethod, body?: any): FetchReturn<T> {\n  const [error, setError] = useState<FetchError | null>(null);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [response, setResponse] = useState<T | null>(null);\n\n  useEffect(() => {\n    const sendRequest = async () => {\n      try {\n        const data = await fetchResource(path, method, body);\n        setResponse(data);\n      } catch (error) {\n        setError(error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    sendRequest();\n\n  }, [path, method, body,]);\n\n  return [loading, response, error];\n};\n\nexport const fetchResource = async (path: string, method: FetchMethod, body?: any) => {\n  if (!path) {\n    throw new Error(`'url' is required for fetching data`);\n  }\n\n  const url = `${API_URL}${path}`;\n  const options: AxiosRequestConfig = {\n    url,\n    method,\n    data: body,\n    timeout: 6000,\n    withCredentials: true,\n    xsrfHeaderName: CSRF_HEADER,\n    headers: {},\n  };\n\n  if (csrfToken.length > 0) {\n    options.headers[CSRF_HEADER] = csrfToken;\n  }\n\n  try {\n    const response = await axios(options);\n\n    if (response.headers[CSRF_HEADER]) {\n      csrfToken = response.headers[CSRF_HEADER];\n    }\n\n    return await response.data;\n  } catch (error) {\n    if (error.response) {\n      console.warn('useFetch error', error.response);\n      const returnError: FetchError = {\n        status: error.response.status,\n        message: error.response.data ? error.response.data.errors.join(', ') : error.message,\n        errors: error.response.data.errors,\n      };\n      throw returnError;\n    } else {\n      console.warn('useFetch error', error);\n      const returnError: FetchError = {\n        status: 500,\n        message: error.message,\n        errors: [error.message]\n      };\n      throw returnError;\n    }\n  }\n\n\n};\n\nexport default useFetch;","import React from 'react';\nimport { Form, Container } from 'react-bootstrap';\n\nimport { useStateValue } from 'store/state';\nimport { fetchResource } from 'util/fetch';\nimport { useImmer } from 'use-immer';\n\ntype State = {\n  username: string,\n};\n\nexport default () => {\n  const { dispatch } = useStateValue();\n  const [localState, setState] = useImmer<State>({\n    username: '',\n  });\n\n  const handleSubmit = (e: React.ChangeEvent<any>) => {\n    e.preventDefault();\n\n    const body = {\n      username: localState.username,\n    };\n    fetchResource('/auth', 'POST', body).then(data => {\n      if (!data || !data.user.uuid) {\n        console.warn('Invalid user object');\n        dispatch({\n          type: 'login',\n          payload: null,\n        })\n        return;\n      }\n\n      dispatch({\n        type: 'login',\n        payload: data,\n      })\n    }).catch(reason => {\n      dispatch({\n        type: 'offline',\n        payload: null,\n      })\n\n      dispatch({\n        type: 'login',\n        payload: null,\n      })\n    });\n  };\n\n  return (\n    <Container className='mt-4'>\n      <Form noValidate onSubmit={handleSubmit}>\n        <Form.Group controlId=\"loginForm.username\">\n          <Form.Label>User name</Form.Label>\n          <Form.Control\n            as=\"input\"\n            type=\"text\"\n            autoFocus\n            onChange={e => {\n              const value = e.currentTarget.value;\n              setState(draft => { draft.username = value });\n            }}\n            value={ localState.username }\n          />\n        </Form.Group>\n      </Form>\n    </Container>\n  );\n};","import React from \"react\";\nimport { Switch } from \"react-router-dom\";\n\nimport Chat from \"sections/Chat\";\nimport AuthenticatedRoute from \"util/AuthenticatedRoute\";\nimport UnauthenticatedRoute from \"util/UnauthenticatedRoute\";\nimport OfflineCheck from \"components/OfflineCheck\";\nimport Login from \"sections/Login\";\n\nexport default () => {\n  return (\n    <>\n      <div id=\"content\">\n        <OfflineCheck />\n        <Switch>\n          <UnauthenticatedRoute path='/login' component={ Login } />\n          <AuthenticatedRoute path=\"/\" component={ Chat } />\n        </Switch>\n      </div>\n    </>\n  );\n};\n","import { library } from \"@fortawesome/fontawesome-svg-core\";\n\n// Icons available in two styles, regular and solid\n// solid tends to have all free icons, while some regular ones are PRO only\nimport {\n    faCoins,\n    faCreditCard,\n    faAt,\n    faColumns,\n    faCog,\n    faArrowUp,\n    faArrowDown,\n    faSignOutAlt,\n    faSignInAlt,\n    faSave,\n    faQuestionCircle,\n    faHeart,\n    faAngleRight,\n    faSpinner,\n    faPlus,\n    faTrash,\n    faExclamationTriangle,\n} from \"@fortawesome/free-solid-svg-icons\";\n\nimport {\n    faSmile,\n} from \"@fortawesome/free-regular-svg-icons\";\n\nimport {\n    faGoogle,\n    faGithub,\n} from \"@fortawesome/free-brands-svg-icons\";\n\n/**\n * All icons that will be used in this app need to be preloaded here\n */\n\nexport default () => {\n  const faGoogleFix: any = faGoogle;\n  const faGithubFix: any = faGithub;\n  library.add(\n    faCoins,\n    faCreditCard,\n    faAt,\n    faColumns,\n    faCog,\n    faArrowDown,\n    faArrowUp,\n    faSignOutAlt,\n    faSignInAlt,\n    faSave,\n    faQuestionCircle,\n    faSmile,\n    faHeart,\n    faAngleRight,\n    faGoogleFix,\n    faGithubFix,\n    faSpinner,\n    faPlus,\n    faTrash,\n    faExclamationTriangle,\n  );\n};\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { BrowserRouter } from \"react-router-dom\";\nimport Helmet from \"react-helmet\";\n\nimport { StateProvider } from \"store/state\";\nimport SocketProvider from \"util/socketProvider\";\n\nimport loadIcons from \"./lib/icons\";\nimport Router from \"./router\";\n\nimport \"assets/scss/index.scss\";\n\n\nloadIcons();\n\nconst app = (\n  <BrowserRouter basename={process.env.REACT_APP_BASEPATH}>\n    <Helmet\n      titleTemplate='%s | dotdot'\n    />\n    <StateProvider>\n      <SocketProvider>\n        <Router />\n      </SocketProvider>\n    </StateProvider>\n  </BrowserRouter>\n);\n\nReactDOM.render(app, document.getElementById(\"root\"));\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"offline\":\"OfflineCheck_offline__2vKbm\"};"],"sourceRoot":""}