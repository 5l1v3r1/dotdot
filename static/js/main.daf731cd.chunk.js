(this.webpackJsonpdotdot=this.webpackJsonpdotdot||[]).push([[0],{111:function(e,t,a){e.exports={textBox:"TextBox_textBox__McZeC",private:"TextBox_private__1kesE",command:"TextBox_command__1uXWO"}},112:function(e,t,a){e.exports={passwordLock:"PasswordLock_passwordLock__2FTiA",unlocked:"PasswordLock_unlocked__21MTQ",pulse:"PasswordLock_pulse__2T-_F",locked:"PasswordLock_locked__1mCl-"}},150:function(e,t,a){e.exports={offline:"OfflineCheck_offline__2vKbm"}},238:function(e,t,a){e.exports={chat:"Chat_chat__LEZtX"}},244:function(e,t,a){e.exports={onlineUsers:"OnlineUsers_onlineUsers__2Umxk"}},248:function(e,t,a){e.exports={login:"Login_login__38Hzs"}},251:function(e,t,a){e.exports=a.p+"static/media/newMessage.482e2f99.mp3"},279:function(e,t,a){e.exports=a(525)},29:function(e,t,a){e.exports={message:"Message_message__2v30T",mention:"Message_mention__82QFp",system:"Message_system__2g6ZE",user:"Message_user__3HofW",timestamp:"Message_timestamp__2armv",offline:"Message_offline__32gHu",icon:"Message_icon__ATXFm",body:"Message_body__32TEj",draft:"Message_draft__1zB7h",header:"Message_header__3wUCX",private:"Message_private__ORZ48"}},490:function(e,t){},524:function(e,t,a){},525:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(17),o=a.n(s),c=a(53),l=a(13),i=a(76),u={CONNECT:"connect",DISCONNECT:"disconnect",MESSAGE:"message",COMMAND:"command",HISTORY:"history",ONLINE_USERS:"users",STATS:"stats",TIMER:"timer",CONTROL:"control"},m="https://api.dotdot.im",d=/^[A-Za-z0-9]+(?:[ _][A-Za-z0-9]+)*_?$/i,f=a(532),p=a(533),g=a(236),h=a(534),v=a(18),E=function(e){for(var t=e.data.map((function(e,t){return{date:t,value:e}})),a=t.length;a<y;a++)t.push({date:a,value:0});return r.a.createElement("div",{style:{width:"100%",height:"".concat(e.height||250,"px")}},r.a.createElement(v.g,null,r.a.createElement(v.b,{data:t,barSize:5,barCategoryGap:2,barGap:2,margin:{top:50,bottom:20,left:0,right:0}},r.a.createElement(v.j,{allowDecimals:!1}),r.a.createElement(v.i,{dataKey:"date",tick:!1},r.a.createElement(v.e,{value:e.label,position:"bottom",offset:-15,fill:"#ccc"})),r.a.createElement(v.a,{dataKey:"value",fill:"#f75f00",stroke:"#f75f00",isAnimationActive:!1,type:"linear"}),r.a.createElement(v.h,{cursor:{fill:"rgba(255, 255, 255, 0.1)"}}))))};function b(e){for(var t=[[Math.floor(e/31536e3),"years"],[Math.floor(e%31536e3/86400),"days"],[Math.floor(e%31536e3%86400/3600),"hours"],[Math.floor(e%31536e3%86400%3600/60),"minutes"],[e%31536e3%86400%3600%60,"seconds"]],a="",n=0,r=t.length;n<r;n++)0!==t[n][0]&&(a+=" "+t[n][0]+" "+(1===t[n][0]?t[n][1].substr(0,t[n][1].length-1):t[n][1]));return a.trim()}var y=100,_=function(){var e=x().state,t=[{header:"Total users now",data:e.stats.onlineUsers},{header:"Total users",data:e.stats.totalUsers},{header:"Total messages",data:e.stats.totalMessages},{header:"CPU usage",data:e.stats.cpuUsage+"%"},{header:"Free memory",data:e.stats.freeMemory+"%"},{header:"Server Uptime",data:b(e.stats.uptime)}],a=e.stats.rooms;return r.a.createElement(f.a,{fluid:!0},r.a.createElement(p.a,null,r.a.createElement(g.a,null,r.a.createElement(E,{data:e.stats.messages,label:"Messages / minute"})),r.a.createElement(g.a,null,r.a.createElement(E,{data:e.stats.users,label:"Users / minute"}))),r.a.createElement(p.a,null,r.a.createElement(g.a,null,r.a.createElement("div",{style:{width:"100%",height:"400px"}},r.a.createElement(v.g,null,r.a.createElement(v.d,{data:a,barSize:10,margin:{top:50,bottom:0,left:0,right:0}},r.a.createElement(v.j,{allowDecimals:!1,domain:[0,10]}),r.a.createElement(v.i,{tick:!1},r.a.createElement(v.e,{value:"Rooms",position:"bottom",offset:-15,fill:"#ccc"})),r.a.createElement(v.c,{dataKey:"active",stackId:"a",fill:"#f75f00"}),r.a.createElement(v.c,{dataKey:"inactive",stackId:"a",fill:"#555"}),r.a.createElement(v.h,{cursor:{fill:"rgba(255, 255, 255, 0.1)"}}),r.a.createElement(v.f,null)))))),r.a.createElement(p.a,null,r.a.createElement(g.a,null,r.a.createElement(h.a,{size:"sm",variant:"dark",className:"mt-4"},r.a.createElement("tbody",null,t.map((function(e){return r.a.createElement("tr",{key:e.header},r.a.createElement("th",{style:{width:"230px"}},e.header),r.a.createElement("td",null,e.data))})))))))},w=Object(i.a)((function(e,t){switch(t.type){case"login":if(e.offline||(e.auth.checked=!0),!t.payload){e.auth.loggedIn=!1,e.auth.user=null;break}e.offline=!1,e.auth.loggedIn=!0,e.auth.user=t.payload.user;break;case"offline":e.offline=!0,e.error=null,e.socket.connected=!1;break;case"error":e.error=t.payload;break;case"socket_".concat(u.CONNECT):e.socket.connected=!0,e.offline=!1,e.error=null;break;case"socket_".concat(u.DISCONNECT):e.socket.connected=!1,e.offline=!0,e.error=null;break;case"socket_".concat(u.ONLINE_USERS):e.onlineUsers=t.payload.users;break;case"user_password":e.auth.user&&(e.auth.user.hasPassword=!0);break;case"socket_".concat(u.MESSAGE):var a=t.payload,n=e.messages.findIndex((function(e){return e.attributes.draft&&e.user.user_id===a.user.user_id}));if(n>-1&&e.messages.splice(n,1),a.message.trim().length<1)return;if(!a.attributes.draft){var r=e.messages[e.messages.length-1];if(r&&r.user.user_id===a.user.user_id&&r.attributes.private===a.attributes.private)return r.message+="\n".concat(a.message),void(r.timestamp=new Date(a.timestamp))}e.messages.push({timestamp:new Date(a.timestamp),attributes:a.attributes,message:a.message,user:a.user}),e.messages.length>100&&e.messages.shift();break;case"socket_".concat(u.HISTORY):e.messages=t.payload.map((function(e){return e.timestamp=new Date(e.timestamp),e}));break;case"socket_".concat(u.STATS):e.stats.messages.push(t.payload.messages),e.stats.messages.length>y&&e.stats.messages.shift(),e.stats.users.push(t.payload.users),e.stats.users.length>y&&e.stats.users.shift(),e.stats.rooms=t.payload.rooms,e.stats.onlineUsers=t.payload.users,e.stats.totalUsers=t.payload.totalUsers,e.stats.totalMessages=t.payload.totalMessages,e.stats.cpuUsage=Math.round(100*t.payload.cpuUsage),e.stats.freeMemory=Math.round(100*t.payload.freeMemory),e.stats.uptime=Math.round(t.payload.uptime);break;case"socket_".concat(u.CONTROL):Object.keys(t.payload).forEach((function(a){"undefined"!==typeof e[a]&&(e[a]=t.payload[a])}))}})),k={auth:{checked:!1,loggedIn:!1,user:null},socket:{connected:!1},draftTimer:100,onlineUsers:[],messages:[],stats:{messages:new Array(y).fill(0),users:new Array(y).fill(0),rooms:[],onlineUsers:0,totalUsers:0,totalMessages:0,cpuUsage:0,freeMemory:0,uptime:0},offline:!1,error:null},O=r.a.createContext({state:k,dispatch:function(){return console.warn("Using default reducer, check StateProvider"),k}}),C=function(e){var t=r.a.useReducer(w,e.state||k),a=Object(l.a)(t,2),n={state:a[0],dispatch:a[1]};return r.a.createElement(O.Provider,{value:n},e.children)},j=function(){return r.a.useContext(O)},x=j,T=a(237),M=a.n(T),S=Object(n.createContext)({socket:null}),N=function(e){var t=j(),a=t.state,s=t.dispatch,o=Object(n.useState)(null),c=Object(l.a)(o,2),i=c[0],d=c[1];Object(n.useEffect)((function(){if(s({type:"error",payload:null}),a.auth.loggedIn){var e=M()(m,{reconnection:!0,timeout:2e3});setInterval((function(){e.connected&&e.emit("timer")}),3e4),Object.values(u).forEach((function(t){e.on(t,(function(e){s({type:"socket_".concat(t),payload:e})}))})),e.on("stats",(function(e){s({type:"stats",payload:e})})),e.on("connect_error",(function(){s({type:"offline",payload:null})})),e.on("connect_timeout",(function(){s({type:"offline",payload:null})})),e.on("error",(function(e){s({type:"socketConnected",payload:!1}),e?(s({type:"error",payload:e}),s({type:"login",payload:null})):s({type:"offline",payload:null})})),d(e)}}),[s,a.auth.loggedIn]);var f={socket:i};return r.a.createElement(S.Provider,{value:f},e.children)},L=a(49),A=a(84),U=a.n(A),F=function(e){var t={};return e.infinite&&(t.animationIterationCount="infinite",t.animationDirection="alternate"),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:U.a.logo},r.a.createElement("div",{className:U.a.blob,style:t}),r.a.createElement("div",{className:U.a.blob,style:t})),r.a.createElement("svg",{className:U.a.svgFilter,xmlns:"http://www.w3.org/2000/svg",version:"1.1"},r.a.createElement("defs",null,r.a.createElement("filter",{id:"goo"},r.a.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"10",result:"blur"}),r.a.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"goo"}),r.a.createElement("feBlend",{in:"SourceGraphic",in2:"goo"})))))},I=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(F,{infinite:!0}))},P=a(238),D=a.n(P),B=a(540),R=a(47),z=a(2),G=a.n(z),H=a(44),K=a(239),Z=a.n(K),V=a(23),q=a(539),J=a(536),X=a(29),Y=a.n(X),Q=function(e){var t,a,n,s=x().state,o=s.onlineUsers.find((function(t){return t.user_id===e.message.user.user_id}))||e.message.user,c="#".concat(o.color),l="dotdot"===o.user_id,i=l||s.onlineUsers.findIndex((function(e){return e.user_id===o.user_id}))>-1&&o.isActive,u="circle";o.icon?u=o.icon:o.user_id===(null===(t=s.auth.user)||void 0===t?void 0:t.user_id)&&(u="dot-circle"),l?u="cog":e.message.attributes.draft?u="circle-notch":e.message.attributes.private?u="lock":i||(u="meh");var m=u;o.user_id===(null===(a=s.auth.user)||void 0===a?void 0:a.user_id)&&(m=["far",u]);var d=Z()(e.message.message,/@([A-Za-z0-9]+(?:[_][A-Za-z0-9]+)*_?)/gim,(function(e,t){var a={},n=s.onlineUsers.findIndex((function(t){return t.name===e}));return n>-1&&(a={color:"#".concat(s.onlineUsers[n].color)}),r.a.createElement("span",{key:t,className:Y.a.mention,style:a},"@",e)}));return r.a.createElement("div",{className:G()(Y.a.message,(n={},Object(H.a)(n,Y.a.system,l),Object(H.a)(n,Y.a.offline,!i),Object(H.a)(n,Y.a.draft,e.message.attributes.draft),Object(H.a)(n,Y.a.private,e.message.attributes.private),n)),key:e.message.timestamp.toDateString()},r.a.createElement("div",{className:G()(Y.a.icon,Object(H.a)({},Y.a.private,e.message.attributes.private)),style:{color:c,background:c}},e.message.attributes.private&&r.a.createElement(q.a,{placement:"right",overlay:r.a.createElement(J.a,{id:"user-".concat(o.user_id)},"Private message from ",r.a.createElement("b",null,"@",o.name),r.a.createElement("br",null),"Only you can see this.")},r.a.createElement(V.a,{icon:m})),!e.message.attributes.private&&r.a.createElement(V.a,{icon:m,spin:e.message.attributes.draft})),r.a.createElement("div",{className:G()(Y.a.timestamp)},e.message.attributes.draft?"now":e.message.timestamp.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})),r.a.createElement("span",{className:G()(Y.a.user),style:{color:c}},o.name),r.a.createElement("div",{className:G()(Y.a.body)},d))},W=a(85),$=a.n(W),ee=function(e){var t=e.boxRef,a=e.onScrollChanged,s=e.threshold,o=e.children,c=Object(n.useState)(-1),i=Object(l.a)(c,2),u=i[0],m=i[1],d=Object(n.useState)(0),f=Object(l.a)(d,2),p=f[0],g=f[1],h=Object(n.useRef)(null),v=Object(n.useCallback)((function(e){clearTimeout(h.current),a&&(h.current=setTimeout((function(){a(e)}),150))}),[a]),E=Object(n.useCallback)((function(){if(t&&t.current){var e=t.current.scrollHeight-t.current.offsetHeight;t.current.scrollTop=e,m(t.current.scrollTop),v(!0)}}),[t,v,m]),b=Object(n.useCallback)((function(e){return function(){if(t&&t.current){if(u>0){var a=s||100;if(u>0&&Math.abs(t.current.scrollTop-u)>a)return void v(!1);v(!0)}e&&E()}}}),[t,v,s,E,u]);return Object(n.useEffect)((function(){return window.addEventListener("resize",E,!0),t&&t.current&&t.current.addEventListener("scroll",b(!1),!0),function(){window.removeEventListener("resize",E,!0)}}),[t,E,b]),Object(n.useEffect)((function(){if(t.current){var e=t.current.scrollHeight;e!==p&&(g(e),b(!0)())}}),[t,p,b,o]),r.a.createElement(r.a.Fragment,null,o)},te=function(){var e=x().state,t=Object(R.a)({scrollAtBottom:!0,unseenMessages:!1}),a=Object(l.a)(t,2),s=a[0],o=a[1],c=Object(n.useRef)(null),i=Object(n.useCallback)((function(e){o((function(t){t.scrollAtBottom=e,e&&(t.unseenMessages=!1)}))}),[o]),u=Object(n.useCallback)((function(){if(c&&c.current){var e=c.current.scrollHeight-c.current.offsetHeight;c.current.scrollTop=e,o((function(e){e.unseenMessages=!1}))}}),[o]);return Object(n.useEffect)((function(){o((function(e){e.unseenMessages=!e.scrollAtBottom}))}),[e.messages,o]),r.a.createElement("div",{className:$.a.messages},s.unseenMessages&&r.a.createElement("div",{className:G()($.a.unseen)},r.a.createElement(f.a,{className:$.a.unseenContainer},r.a.createElement(B.a,{variant:"outline-secondary",size:"sm",onClick:u},r.a.createElement(V.a,{icon:"arrow-alt-circle-down"})," New messages"))),r.a.createElement("div",{className:G()($.a.messageScroll),ref:c},r.a.createElement("div",{className:"container"},r.a.createElement(ee,{boxRef:c,onScrollChanged:i},e.messages.map((function(e){return r.a.createElement(Q,{key:e.timestamp.getTime(),message:e})}))))))},ae=a(538),ne=a(111),re=a.n(ne),se=function(){var e,t=x().state,a=Object(R.a)({message:"",private:!1,to:null,isCommand:!1}),s=Object(l.a)(a,2),o=s[0],c=s[1],i=Object(n.useRef)(null),m=Object(n.useContext)(S).socket,f=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t||!(e.length<1||e.trim().length<1)){var a=u.MESSAGE;o.isCommand&&(a=u.COMMAND),null===m||void 0===m||m.emit(a,{message:e,attributes:{draft:t,private:o.private,to:o.to}})}},p="lock";return o.isCommand&&(p="code"),r.a.createElement(ae.a,{noValidate:!0,onSubmit:function(e){e.preventDefault(),o.message.length<1||o.message.trim().length<1||(f(o.message),c((function(e){e.message="",e.private=!1,e.isCommand=!1})))},className:G()(re.a.textBox,"container",(e={},Object(H.a)(e,re.a.private,o.private),Object(H.a)(e,re.a.command,o.isCommand),e))},r.a.createElement(ae.a.Group,{controlId:"chatForm.message"},r.a.createElement(ae.a.Control,{as:"input",type:"text",placeholder:"Type a message...",autoFocus:!0,onChange:function(e){e.preventDefault(),clearTimeout(i.current);var a=e.currentTarget.value,n=!1,r=!1,s=null;if("/"===a[0])n=!0;else if("@"===a[0]){var o=a.split(" ");r=!0,o.length>0&&"@"===o[0][0]&&d.test(o[0].substr(1))&&(s=o[0].substr(1))}c((function(e){e.message=a,e.private=r,e.to=s,e.isCommand=n})),r||n||t.draftTimer>0&&(i.current=setTimeout((function(){f(a,!0)}),t.draftTimer))},value:o.message}),r.a.createElement("span",null,r.a.createElement(V.a,{icon:p}))))},oe=a(244),ce=a.n(oe),le=function(){var e=x().state;return r.a.createElement("div",{className:ce.a.onlineUsers},e.onlineUsers.map((function(t){var a,n,s=t.user_id===(null===(a=e.auth.user)||void 0===a?void 0:a.user_id),o="circle";t.icon?o=t.icon:t.user_id===(null===(n=e.auth.user)||void 0===n?void 0:n.user_id)&&(o="dot-circle"),t.isActive||(o="meh");var c=o;return s&&(c=["far",o]),r.a.createElement(q.a,{key:t.user_id,placement:"bottom",overlay:r.a.createElement(J.a,{id:"user-".concat(t.user_id)},"@",t.name)},r.a.createElement("span",{style:{color:"#".concat(t.color)}},r.a.createElement(V.a,{icon:c})))})))},ie=a(537),ue=a(112),me=a.n(ue),de=a(86),fe=a.n(de),pe=a(146),ge=a(147),he=a.n(ge),ve="";he.a.defaults.withCredentials=!0;var Ee=function(){var e=Object(pe.a)(fe.a.mark((function e(t,a,n){var r,s,o;return fe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("'url' is required for fetching data");case 2:return r="".concat(m).concat(t),s={url:r,method:a,data:n,timeout:6e3,withCredentials:!0,xsrfHeaderName:"x-csrf-token",headers:{}},ve.length>0&&(s.headers["x-csrf-token"]=ve),e.prev=5,e.next=8,he()(s);case 8:return(o=e.sent).headers["x-csrf-token"]&&(ve=o.headers["x-csrf-token"]),e.next=12,o.data;case 12:return e.abrupt("return",e.sent);case 15:if(e.prev=15,e.t0=e.catch(5),!e.t0.response){e.next=21;break}throw console.warn("useFetch error on ".concat(a," ").concat(t),e.t0.response),{status:e.t0.response.status,message:be(e.t0),errors:ye(e.t0),data:e.t0.response.data};case 21:throw console.warn("useFetch network error on ".concat(a," ").concat(t),e.t0),{status:500,message:e.t0.message,errors:[e.t0.message]};case 24:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(t,a,n){return e.apply(this,arguments)}}();function be(e){return e.response&&e.response.data?ye(e).join(". "):e.message||"An error occurred"}function ye(e){return e.response&&e.response.data?function(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t++){var a=t+1<1||arguments.length<=t+1?void 0:arguments[t+1];if(Array.isArray(a))return a;if("string"===typeof a)return[a]}return[e]}("An error occurred",e.response.data,e.response.data.errors,e.response.data.error):[e.message||"An error occurred"]}var _e=function(){var e=x(),t=e.state,a=e.dispatch,s=Object(n.useState)(!1),o=Object(l.a)(s,2),c=o[0],i=o[1],u=Object(n.useState)(!1),d=Object(l.a)(u,2),f=d[0],p=d[1],g=Object(n.useState)(""),h=Object(l.a)(g,2),v=h[0],E=h[1],b=Object(n.useState)(""),y=Object(l.a)(b,2),_=y[0],w=y[1],k=function(){return i(!1)},O=me.a.unlocked,C="lock-open",j="Set a password to keep your username",T="Claim Username";return t.auth.user&&t.auth.user.hasPassword&&(O=me.a.locked,C="lock",j="Change your password",T="Update Password"),r.a.createElement("span",{className:me.a.passwordLock},r.a.createElement(q.a,{placement:"bottom",delay:500,overlay:r.a.createElement(J.a,{id:"passwordLock"},j)},r.a.createElement(B.a,{variant:"link",className:O,style:{padding:0},onClick:function(){return i(!0)}},r.a.createElement(V.a,{icon:C}))),r.a.createElement(ie.a,{show:c,onHide:k},r.a.createElement(ae.a,{noValidate:!0,validated:f,onSubmit:function(e){(e.preventDefault(),e.stopPropagation(),p(!0),e.currentTarget.checkValidity())&&Ee("/password","POST",{password:v,repeatPassword:_}).then((function(){a({type:"user_password",payload:!0}),i(!1),p(!1),E(""),w("")})).catch((function(e){a({type:"error",payload:e.errors.join(", ")})}))}},r.a.createElement(ie.a.Header,{closeButton:!0},r.a.createElement(ie.a.Title,null,T)),r.a.createElement(ie.a.Body,null,r.a.createElement(ae.a.Group,{controlId:"pwd.new"},r.a.createElement(ae.a.Control,{as:"input",type:"password",placeholder:"Password...",autoFocus:!0,required:!0,minLength:6,onChange:function(e){E(e.currentTarget.value)},value:v}),r.a.createElement(ae.a.Control.Feedback,{type:"invalid"},"The password is too short. Minimum length is 6 characters.")),r.a.createElement(ae.a.Group,{controlId:"pwd.new"},r.a.createElement(ae.a.Control,{as:"input",type:"password",placeholder:"Repeat Password...",required:!0,minLength:6,pattern:v,onChange:function(e){w(e.currentTarget.value)},value:_}),r.a.createElement(ae.a.Control.Feedback,{type:"invalid"},"The passwords don't match!"))),r.a.createElement(ie.a.Footer,null,r.a.createElement("a",{href:"".concat(m,"/logout")},"Logout"),r.a.createElement(B.a,{variant:"secondary",onClick:k},"Close"),r.a.createElement(B.a,{type:"submit",variant:"primary"},"Set password")))))},we=function(){var e,t=j().state,a=r.a.createElement(I,null);t.socket.connected&&(a=r.a.createElement("div",{className:D.a.chat},r.a.createElement(f.a,null,r.a.createElement(p.a,null,r.a.createElement(g.a,null,r.a.createElement(_e,null),(null===(e=t.auth.user)||void 0===e?void 0:e.isAdmin)&&r.a.createElement(c.b,{to:"/admin",title:"Monitoring",style:{marginLeft:"1em"}},r.a.createElement(V.a,{icon:"shield-alt"}))),r.a.createElement(g.a,null,r.a.createElement(le,null)))),r.a.createElement(te,null),r.a.createElement(se,null)));return a},ke=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(I,null))},Oe=function(e){var t=j().state;return t.auth.checked?t.auth.loggedIn?r.a.createElement(L.b,{path:e.path,exact:e.exact,component:e.component}):r.a.createElement(L.a,{to:"/login"}):r.a.createElement(ke,null)},Ce=function(e){var t=j().state;return t.auth.checked?t.auth.loggedIn?r.a.createElement(L.a,{to:"/"}):r.a.createElement(L.b,{path:e.path,exact:e.exact,component:e.component}):r.a.createElement(ke,null)},je=a(150),xe=a.n(je),Te=function(){var e=j().state;if(!e.offline&&!e.error)return null;var t=e.error;return Array.isArray(t)&&(t=t.join(". ")),"string"!==typeof t&&(t=String(t)),e.error?r.a.createElement("div",{className:xe.a.offline},"Error: ",t):r.a.createElement("div",{className:xe.a.offline},"You seem to be offline! Please try again later")},Me=a(247),Se=a.n(Me),Ne=a(248),Le=a.n(Ne),Ae=function(){var e=j().dispatch,t=Object(R.a)({username:"",password:"",verified:!1,hasPassword:!1,loading:!1}),a=Object(l.a)(t,2),s=a[0],o=a[1],c=Object(n.useRef)(null),i=function(t){if(t&&!s.loading){o((function(e){e.loading=!0}));var a={username:s.username,password:s.password,captchaToken:t};Ee("/auth","POST",a).then((function(t){if(!t||!t.user.user_id)return console.warn("Invalid user object"),void e({type:"login",payload:t});e({type:"login",payload:t})})).catch((function(t){400!==t.status&&e({type:"error",payload:t.errors.join(", ")}),c.current.resetCaptcha&&c.current.resetCaptcha(),o((function(e){e.loading=!1,e.verified=t.data&&t.data.verified||!1,400===t.status&&(e.hasPassword=!0)}))}))}},u="light";return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(u="dark"),r.a.createElement(f.a,{className:G()(Le.a.login,"mt-4")},r.a.createElement(F,null),r.a.createElement(ae.a,{noValidate:!0,onSubmit:function(e){e.preventDefault(),s.verified?i("verified"):c.current.execute()}},r.a.createElement(ae.a.Group,{controlId:"loginForm.username"},r.a.createElement(ae.a.Control,{as:"input",type:"text",placeholder:"What's your name?",disabled:s.loading,autoFocus:!0,minLength:1,maxLength:20,onChange:function(e){var t=e.currentTarget.value;o((function(e){e.username=t}))},value:s.username}),s.hasPassword&&r.a.createElement(ae.a.Control,{as:"input",className:"mt-2",type:"password",placeholder:"Password...",disabled:s.loading,autoFocus:!0,onChange:function(e){var t=e.currentTarget.value;o((function(e){e.password=t}))},value:s.password}),r.a.createElement(Se.a,{ref:c,size:"invisible",theme:u,sitekey:"562bb3f7-9944-46f3-aca9-553dd470a8c1",onVerify:i}),r.a.createElement("button",{type:"submit",style:{visibility:"hidden"}},"Login"))))},Ue=function e(t){Ee("/auth","GET").then((function(e){if(!e||!e.user.user_id)return console.warn("Invalid user object"),void t({type:"login",payload:null});t({type:"login",payload:e})})).catch((function(a){"Network Error"===a.message?(t({type:"offline",payload:null}),setTimeout((function(){e(t)}),2e3)):(401!==a.status&&t({type:"error",payload:a.errors.join(", ")}),t({type:"login",payload:null}))}))},Fe=function(){var e=x(),t=e.state,a=e.dispatch;return Object(n.useEffect)((function(){t.auth.checked||Ue(a)}),[t.auth.checked,a]),r.a.createElement(r.a.Fragment,null,r.a.createElement(Te,null),r.a.createElement(L.d,null,r.a.createElement(Ce,{path:"/login",component:Ae}),r.a.createElement(Oe,{path:"/admin",component:_}),r.a.createElement(Oe,{path:"/",component:we})))},Ie=a(249),Pe=a.n(Ie),De=a(250),Be=a(251),Re=a.n(Be),ze=function(){var e=x().state,t=Object(R.a)({lastSound:new Date,windowFocused:!0,titleNotification:!1}),a=Object(l.a)(t,2),s=a[0],o=a[1],c=Object(n.useContext)(S).socket,i=Object(De.a)(Re.a,{interrupt:!0,volume:.5}),u=Object(l.a)(i,1)[0],m=Object(n.useCallback)((function(e){return function(t){t.attributes.draft||e===t.user.user_id||o((function(e){e.windowFocused||(e.titleNotification=!0,(!e.lastSound||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;return t.getTime()-e.getTime()}(e.lastSound)>5e3)&&(e.lastSound=new Date,u({})))}))}}),[o,u]),d=Object(n.useCallback)((function(){o((function(e){e.titleNotification=!1,e.windowFocused=!0}))}),[o]),f=Object(n.useCallback)((function(){o((function(e){e.windowFocused=!1}))}),[o]),p=e.auth.user?e.auth.user.user_id:null;return Object(n.useEffect)((function(){c&&p&&c.on("message",m(p))}),[c,m,p]),Object(n.useEffect)((function(){return window.addEventListener("focus",d),window.addEventListener("blur",f),function(){window.removeEventListener("focus",d),window.removeEventListener("blur",f)}}),[d,f]),r.a.createElement(Pe.a,null,r.a.createElement("title",null,s.titleNotification?"\u2022\u2022 dotdot":"dotdot"))},Ge=a(77),He=a(9),Ke=a(11);Ge.b.add(He.G,He.H,He.c,He.h,Ke.c,He.d,He.e,He.f,He.b,He.I,Ke.B,He.a,He.g,He.i,He.j,He.k,He.l,He.m,He.n,He.o,He.p,He.q,He.r,He.s,He.t,He.u,He.v,He.w,He.x,He.y,He.z,He.A,He.B,He.C,He.D,He.E,He.F,He.J,He.K,He.L,He.M,He.O,He.P,He.Q,He.R,He.S,Ke.a,Ke.b,Ke.d,Ke.e,Ke.f,Ke.g,Ke.h,Ke.i,Ke.j,Ke.k,Ke.l,Ke.m,Ke.n,Ke.o,Ke.p,Ke.q,Ke.r,Ke.s,Ke.t,Ke.u,Ke.v,Ke.w,Ke.x,Ke.y,Ke.z,Ke.A,Ke.C,Ke.D,Ke.E,Ke.F,Ke.G,Ke.H,Ke.I,Ke.J,Ke.K,He.N);a(524);var Ze=r.a.createElement(c.a,{basename:"/"},r.a.createElement(C,null,r.a.createElement(N,null,r.a.createElement(ze,null),r.a.createElement(Fe,null))));o.a.render(Ze,document.getElementById("root"))},84:function(e,t,a){e.exports={logo:"Logo_logo__30xDu",svgFilter:"Logo_svgFilter__1s9i7",blob:"Logo_blob__1iSwo","blob-first":"Logo_blob-first__3YKrD","blob-second":"Logo_blob-second__2r5Nx"}},85:function(e,t,a){e.exports={messages:"Messages_messages__tCmp1",messageScroll:"Messages_messageScroll__CCnSp",unseen:"Messages_unseen__gVw6f",unseenContainer:"Messages_unseenContainer__3haBw"}}},[[279,1,2]]]);
//# sourceMappingURL=main.daf731cd.chunk.js.map