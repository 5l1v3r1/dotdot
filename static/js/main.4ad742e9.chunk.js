(this.webpackJsonpdotdot=this.webpackJsonpdotdot||[]).push([[0],{114:function(e,t,a){e.exports={chat:"Chat_chat__LEZtX",scrollingChat:"Chat_scrollingChat__165RB",header:"Chat_header__ThKzr"}},153:function(e,t,a){e.exports={offline:"OfflineCheck_offline__2vKbm"}},245:function(e,t,a){e.exports={onlineUsers:"OnlineUsers_onlineUsers__2Umxk"}},248:function(e,t,a){e.exports={login:"Login_login__38Hzs"}},251:function(e,t,a){e.exports=a.p+"static/media/newMessage.482e2f99.mp3"},26:function(e,t,a){e.exports={message:"Message_message__2v30T",mention:"Message_mention__82QFp",system:"Message_system__2g6ZE",user:"Message_user__3HofW",timestamp:"Message_timestamp__2armv",offline:"Message_offline__32gHu",icon:"Message_icon__ATXFm",inactive:"Message_inactive__2OBrK",body:"Message_body__32TEj",draft:"Message_draft__1zB7h",header:"Message_header__3wUCX",private:"Message_private__ORZ48"}},280:function(e,t,a){e.exports=a(526)},491:function(e,t){},525:function(e,t,a){},526:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),r=a(17),o=a.n(r),l=a(53),c=a(13),i=a(77),u={CONNECT:"connect",DISCONNECT:"disconnect",MESSAGE:"message",COMMAND:"command",HISTORY:"history",ONLINE_USERS:"users",STATS:"stats",TIMER:"timer",CONTROL:"control",CHANGE_ROOM:"change_room"},m="https://api.dotdot.im",d=/^[A-Za-z0-9]+(?:[ _][A-Za-z0-9]+)*_?$/i,f="6LddUucUAAAAAIk_E1AoLY5YyxoulIzlyRLjMoMi",p=a(533),h=a(534),g=a(240),E=a(535),v=a(18),b=function(e){for(var t=e.data.map((function(e,t){return{date:t,value:e}})),a=t.length;a<C;a++)t.push({date:a,value:0});return s.a.createElement("div",{style:{width:"100%",height:"".concat(e.height||250,"px")}},s.a.createElement(v.f,null,s.a.createElement(v.b,{data:t,barSize:5,barCategoryGap:2,barGap:2,margin:{top:50,bottom:20,left:0,right:0}},s.a.createElement(v.i,{allowDecimals:!1}),s.a.createElement(v.h,{dataKey:"date",tick:!1},s.a.createElement(v.e,{value:e.label,position:"bottom",offset:-15,fill:"#ccc"})),s.a.createElement(v.a,{dataKey:"value",fill:"#f75f00",stroke:"#f75f00",isAnimationActive:!1,type:"linear"}),s.a.createElement(v.g,{cursor:{fill:"rgba(255, 255, 255, 0.1)"}}))))};function y(e){for(var t=[[Math.floor(e/31536e3),"years"],[Math.floor(e%31536e3/86400),"days"],[Math.floor(e%31536e3%86400/3600),"hours"],[Math.floor(e%31536e3%86400%3600/60),"minutes"],[e%31536e3%86400%3600%60,"seconds"]],a="",n=0,s=t.length;n<s;n++)0!==t[n][0]&&(a+=" "+t[n][0]+" "+(1===t[n][0]?t[n][1].substr(0,t[n][1].length-1):t[n][1]));return a.trim()}var _=a(238),w=a.n(_),k=Object(n.createContext)({socket:null}),O=function(e){var t,a=A(),r=a.state,o=a.dispatch,l=Object(n.useState)(null),i=Object(c.a)(l,2),d=i[0],f=i[1],p=null===(t=r.auth.user)||void 0===t?void 0:t.hasPassword;Object(n.useEffect)((function(){if(r.auth.loggedIn&&!d){o({type:"error",payload:null});var e=w()(m,{reconnection:!0,timeout:2e3});setInterval((function(){e.connected&&e.emit("timer")}),3e4),p||setTimeout((function(){o({type:"system_message",payload:"Remember: If you want to keep this username, you must set a password! You can set it by clicking on the lock icon on the top left of the screen."})}),6e4),Object.values(u).forEach((function(t){e.on(t,(function(e){o({type:"socket_".concat(t),payload:e})}))})),e.on("stats",(function(e){o({type:"stats",payload:e})})),e.on("connect_error",(function(){o({type:"offline",payload:null})})),e.on("connect_timeout",(function(){o({type:"offline",payload:null})})),e.on("error",(function(e){o({type:"socket_".concat(u.DISCONNECT)}),e?(o({type:"error",payload:e}),o({type:"login",payload:null})):o({type:"offline",payload:null})})),f(e)}}),[o,d,r.auth.loggedIn,p]);var h={socket:d};return s.a.createElement(k.Provider,{value:h},e.children)},C=100,x=function(){var e=I().state,t=Object(n.useContext)(k).socket,a=e.stats.timeActive+e.stats.timeInactive,r=[{header:"Users Online",data:"".concat(e.stats.onlineUsers,"  (").concat(Math.round(100*e.stats.onlineUsers/e.stats.totalUsers),"%)")},{header:"Total Users",data:e.stats.totalUsers},{header:"Total Messages",data:e.stats.totalMessages},{header:"CPU Usage",data:e.stats.cpuUsage+"%"},{header:"Free Memory",data:e.stats.freeMemory+"%"},{header:"Server Uptime",data:y(e.stats.uptime)},{header:"Time Active / Ses",data:y(Math.round(e.stats.timeActive/e.stats.sessions))},{header:"Time Inactive / Sess",data:y(Math.round(e.stats.timeInactive/e.stats.sessions))},{header:"Total Sessions",data:e.stats.sessions},{header:"Avg Sessions / user",data:Math.round(e.stats.sessions/e.stats.totalUsers)},{header:"Total Time Active",data:y(e.stats.timeActive)+" ("+Math.round(100*e.stats.timeActive/a)+"%)"},{header:"Total Time Inactive",data:y(e.stats.timeInactive)+" ("+Math.round(100*e.stats.timeInactive/a)+"%)"}],o=e.stats.rooms;return s.a.createElement(p.a,{fluid:!0},s.a.createElement(h.a,null,s.a.createElement(g.a,null,s.a.createElement(b,{data:e.stats.messages,label:"Realtime Messages"})),s.a.createElement(g.a,null,s.a.createElement(b,{data:e.stats.users,label:"Realtime Users"}))),s.a.createElement(h.a,null,s.a.createElement(g.a,null,s.a.createElement("div",{style:{width:"100%",height:"400px"}},s.a.createElement(v.f,null,s.a.createElement(v.d,{onClick:function(e){var a=e.activePayload[0].payload.id;t&&t.emit(u.CHANGE_ROOM,{room:a})},data:o,barSize:10,margin:{top:50,bottom:0,left:0,right:0}},s.a.createElement(v.i,{allowDecimals:!1,domain:[0,10]}),s.a.createElement(v.h,{tick:!1},s.a.createElement(v.e,{value:"Rooms",position:"bottom",offset:-15,fill:"#ccc"})),s.a.createElement(v.c,{dataKey:"active",stackId:"a",fill:"#f75f00"}),s.a.createElement(v.c,{dataKey:"inactive",stackId:"a",fill:"#555"}),s.a.createElement(v.g,{cursor:{fill:"rgba(255, 255, 255, 0.1)"}})))))),s.a.createElement(p.a,null,s.a.createElement(h.a,null,s.a.createElement(g.a,null,s.a.createElement(E.a,{size:"sm",variant:"dark",className:"mt-4"},s.a.createElement("tbody",null,r.map((function(e){return s.a.createElement("tr",{key:e.header},s.a.createElement("th",{style:{width:"230px"}},e.header),s.a.createElement("td",null,e.data))}))))))))},j=Object(i.a)((function(e,t){switch(t.type){case"login":if(e.offline||(e.auth.checked=!0),!t.payload){e.auth.loggedIn=!1,e.auth.user=null;break}e.offline=!1,e.auth.loggedIn=!0,e.auth.user=t.payload.user;break;case"offline":e.offline=!0,e.error=null,e.socket.connected=!1;break;case"error":e.error=t.payload;break;case"user_password":e.auth.user&&(e.auth.user.hasPassword=!0);break;case"system_message":var a={user:T,message:t.payload,timestamp:new Date,attributes:{private:!1,draft:!1}};e.messages.push(a);break;case"socket_".concat(u.CONNECT):e.socket.connected=!0,e.offline=!1,e.error=null;break;case"socket_".concat(u.DISCONNECT):e.socket.connected=!1,e.offline=!0,e.error=null;break;case"socket_".concat(u.ONLINE_USERS):e.onlineUsers=t.payload.users;break;case"socket_".concat(u.MESSAGE):var n=t.payload,s=e.messages.findIndex((function(e){return e.attributes.draft&&e.user.user_id===n.user.user_id}));if(s>-1&&e.messages.splice(s,1),n.message.trim().length<1)return;if(!n.attributes.draft){var r=e.messages[e.messages.length-1];if(r&&r.user.user_id===n.user.user_id&&r.attributes.private===n.attributes.private)return r.message+="\n".concat(n.message),void(r.timestamp=new Date(n.timestamp))}e.messages.push({timestamp:new Date(n.timestamp),attributes:n.attributes,message:n.message,user:n.user}),e.messages.length>100&&e.messages.shift();break;case"socket_".concat(u.HISTORY):e.messages=t.payload.map((function(e){return e.timestamp=new Date(e.timestamp),e}));break;case"socket_".concat(u.STATS):e.stats.messages.push(t.payload.messages),e.stats.messages.length>C&&e.stats.messages.shift(),e.stats.users.push(t.payload.users),e.stats.users.length>C&&e.stats.users.shift(),e.stats.rooms=t.payload.rooms,e.stats.onlineUsers=t.payload.users,e.stats.totalUsers=t.payload.totalUsers,e.stats.totalMessages=t.payload.totalMessages,e.stats.cpuUsage=Math.round(100*t.payload.cpuUsage),e.stats.freeMemory=Math.round(100*t.payload.freeMemory),e.stats.uptime=Math.round(t.payload.uptime),e.stats.timeActive=30*t.payload.timeActive,e.stats.timeInactive=30*t.payload.timeInactive,e.stats.sessions=t.payload.sessions;break;case"socket_".concat(u.CONTROL):Object.keys(t.payload).forEach((function(a){"undefined"!==typeof e[a]&&(e[a]=t.payload[a])}))}})),T={user_id:"dotdot",name:"dotdot",icon:"cog",color:"f75f00",isActive:!0,hasPassword:!0},M={auth:{checked:!1,loggedIn:!1,user:null},socket:{connected:!1},draftTimer:100,onlineUsers:[],messages:[],stats:{messages:new Array(C).fill(0),users:new Array(C).fill(0),rooms:[],onlineUsers:0,totalUsers:0,totalMessages:0,cpuUsage:0,freeMemory:0,uptime:0,timeActive:0,timeInactive:0,sessions:1},offline:!1,error:null},S=s.a.createContext({state:M,dispatch:function(){return console.warn("Using default reducer, check StateProvider"),M}}),N=function(e){var t=s.a.useReducer(j,e.state||M),a=Object(c.a)(t,2),n={state:a[0],dispatch:a[1]};return s.a.createElement(S.Provider,{value:n},e.children)},A=function(){return s.a.useContext(S)},I=A,F=a(50),L=a(29),U=a(2),P=a.n(U),B=a(85),R=a.n(B),D=function(e){var t={};return e.infinite&&(t.animationIterationCount="infinite",t.animationDirection="alternate"),s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:R.a.logo},s.a.createElement("div",{className:R.a.blob,style:t}),s.a.createElement("div",{className:R.a.blob,style:t})),s.a.createElement("svg",{className:R.a.svgFilter,xmlns:"http://www.w3.org/2000/svg",version:"1.1"},s.a.createElement("defs",null,s.a.createElement("filter",{id:"goo"},s.a.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"10",result:"blur"}),s.a.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"goo"}),s.a.createElement("feBlend",{in:"SourceGraphic",in2:"goo"})))))},G=function(e){return s.a.createElement(s.a.Fragment,null,s.a.createElement(D,{infinite:!0}))},z=a(114),H=a.n(z),K=a(541),Y=a(35),W=a(147),Z=a.n(W),q=a(23),V=a(540),J=a(537),X=a(26),Q=a.n(X),$=function(){return s.a.createElement("div",null,s.a.createElement("h4",null,"Welcome to dotdot:"),s.a.createElement("p",null,"This is a place where you can chat with people whenever you want :)",s.a.createElement("br",null),"We don't save any messages, so when the last person in a chat disconnects, the chat history is lost."),s.a.createElement("p",null,"Inactive user accounts are deleted after 2 weeks without chatting."),s.a.createElement("h4",null,"Keep your User"),s.a.createElement("p",null,"You can set a password to protect your username from being deleted and used by someone else. Simply click on the lock in the top left corner."),s.a.createElement("h4",null,"Private Messages"),s.a.createElement("p",null,"You can send anyone a private message simply by starting your message with @ and their name. You'll see the text box change to orange and a lock icon appear."),s.a.createElement("p",null,"Only you and the person you send the message to can see them. If they are offline they won't receive the message"),s.a.createElement("h4",null,"Commands"),s.a.createElement("p",null,"There are some commands that you can use:"),s.a.createElement(E.a,{size:"sm",variant:"dark"},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null,"Command"),s.a.createElement("th",null,"Example"),s.a.createElement("th",null,"Description"))),s.a.createElement("tbody",null,s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement("code",null,"/help")),s.a.createElement("td",null,s.a.createElement("code",null,"/help")),s.a.createElement("td",null,"It shows this message")),s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement("code",null,"/set color")),s.a.createElement("td",null,s.a.createElement("code",null,"/set color eb0000")),s.a.createElement("td",null,"Change your color, the color needs to be a hex representation (sorry if this sounds confusing, soon there will be an easier way to do this)")),s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement("code",null,"/set icon")),s.a.createElement("td",null,s.a.createElement("code",null,"/set icon smile")),s.a.createElement("td",null,"Change your icon, pick any of the ones from ",s.a.createElement("a",{href:"https://fontawesome.com/icons?d=gallery&s=regular&c=emoji&m=free",rel:"noopener noreferrer",target:"_blank"},"this list"))),s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement("code",null,"/list")),s.a.createElement("td",null,s.a.createElement("code",null,"/list")),s.a.createElement("td",null,"Get a list of the users who are currently online")))))},ee=new RegExp("@([A-Za-z0-9]+(?:[_][A-Za-z0-9]+)*_?)","gmi"),te=new RegExp(/((?:ftp|http|https):\/\/(?:\w+:{0,1}\w*@)?(?:\S+)(?::[0-9]+)?(?:\/|\/(?:[\w#!:.?+=&%@!\-/]))?)/,"gmi"),ae=function(e){var t,a,n,r=I().state,o=r.onlineUsers.find((function(t){return t.user_id===e.message.user.user_id}))||e.message.user,l="#".concat(o.color),c="dotdot"===o.user_id,i=c||r.onlineUsers.findIndex((function(e){return e.user_id===o.user_id}))>-1,u="circle";o.icon?u=o.icon:o.user_id===(null===(t=r.auth.user)||void 0===t?void 0:t.user_id)&&(u="dot-circle"),c?u="cog":e.message.attributes.draft?u="circle-notch":e.message.attributes.private?u="lock":i||(u="meh");var m,d=u;return o.user_id===(null===(a=r.auth.user)||void 0===a?void 0:a.user_id)&&(d=["far",u]),c&&"/help"===e.message.message?m=s.a.createElement($,null):(m=Z()(e.message.message,ee,(function(e,t){var a={},n=r.onlineUsers.findIndex((function(t){return t.name===e}));return n>-1&&(a={color:"#".concat(r.onlineUsers[n].color)}),s.a.createElement("span",{key:t,className:Q.a.mention,style:a},"@",e)})),m=Z()(m,te,(function(e){return s.a.createElement("a",{key:e,href:e,rel:"noopener noreferrer",target:"_blank"},e)}))),s.a.createElement("div",{className:P()(Q.a.message,(n={},Object(L.a)(n,Q.a.system,c),Object(L.a)(n,Q.a.offline,!i),Object(L.a)(n,Q.a.inactive,!o.isActive),Object(L.a)(n,Q.a.draft,e.message.attributes.draft),Object(L.a)(n,Q.a.private,e.message.attributes.private),n)),key:e.message.timestamp.toDateString()},s.a.createElement("div",{className:P()(Q.a.icon,Object(L.a)({},Q.a.private,e.message.attributes.private)),style:{color:l,background:l}},e.message.attributes.private&&s.a.createElement(V.a,{placement:"right",overlay:s.a.createElement(J.a,{id:"user-".concat(o.user_id)},"Private message from ",s.a.createElement("b",null,"@",o.name),s.a.createElement("br",null),"Only you can see this.")},s.a.createElement(q.a,{icon:d})),!e.message.attributes.private&&s.a.createElement(q.a,{icon:d,spin:e.message.attributes.draft})),s.a.createElement("div",{className:P()(Q.a.timestamp)},e.message.attributes.draft?"now":e.message.timestamp.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})),s.a.createElement("span",{className:P()(Q.a.user),style:{color:l}},o.name),s.a.createElement("div",{className:P()(Q.a.body)},m))},ne=a(86),se=a.n(ne),re=function(e){var t=e.boxRef,a=e.onScrollChanged,r=e.threshold,o=e.children,l=Object(n.useState)(-1),i=Object(c.a)(l,2),u=i[0],m=i[1],d=Object(n.useState)(0),f=Object(c.a)(d,2),p=f[0],h=f[1],g=Object(n.useRef)(null),E=Object(n.useCallback)((function(e){clearTimeout(g.current),a&&(g.current=setTimeout((function(){a(e)}),150))}),[a]),v=Object(n.useCallback)((function(){if(t&&t.current){var e=t.current.scrollHeight-t.current.offsetHeight;t.current.scrollTop=e,m(t.current.scrollTop),E(!0)}}),[t,E,m]),b=Object(n.useCallback)((function(e){return function(){if(t&&t.current){if(u>0){var a=r||100;if(u>0&&Math.abs(t.current.scrollTop-u)>a)return void E(!1);E(!0)}e&&v()}}}),[t,E,r,v,u]);return Object(n.useEffect)((function(){return window.addEventListener("resize",v,!0),t&&t.current&&t.current.addEventListener("scroll",b(!1),!0),function(){window.removeEventListener("resize",v,!0)}}),[t,v,b]),Object(n.useEffect)((function(){if(t.current){var e=t.current.scrollHeight;e!==p&&(h(e),b(!0)())}}),[t,p,b,o]),s.a.createElement(s.a.Fragment,null,o)},oe=function(){var e=I().state,t=Object(Y.a)({scrollAtBottom:!0,unseenMessages:!1}),a=Object(c.a)(t,2),r=a[0],o=a[1],l=Object(n.useRef)(null),i=Object(n.useCallback)((function(e){o((function(t){t.scrollAtBottom=e,e&&(t.unseenMessages=!1)}))}),[o]),u=Object(n.useCallback)((function(){if(l&&l.current){var e=l.current.scrollHeight-l.current.offsetHeight;l.current.scrollTop=e,o((function(e){e.unseenMessages=!1}))}}),[o]);return Object(n.useEffect)((function(){o((function(e){e.unseenMessages=!e.scrollAtBottom}))}),[e.messages,o]),s.a.createElement("div",{className:se.a.messages},r.unseenMessages&&s.a.createElement("div",{className:P()(se.a.unseen)},s.a.createElement(p.a,{className:se.a.unseenContainer},s.a.createElement(K.a,{variant:"outline-secondary",size:"sm",onClick:u},s.a.createElement(q.a,{icon:"arrow-alt-circle-down"})," New messages"))),s.a.createElement("div",{className:P()(se.a.messageScroll),ref:l},s.a.createElement("div",{className:"container"},s.a.createElement(re,{boxRef:l,onScrollChanged:i},e.messages.map((function(e){return s.a.createElement(ae,{key:e.timestamp.getTime(),message:e})}))))))},le=a(539),ce=a(87),ie=a.n(ce),ue=function(e){var t,a=e.onFocus,r=e.onBlur,o=I(),l=o.state,i=o.dispatch,m=Object(Y.a)({message:"",private:!1,to:null,isCommand:!1}),f=Object(c.a)(m,2),p=f[0],h=f[1],g=Object(n.useRef)(null),E=Object(n.useContext)(k).socket,v=function(){i({type:"system_message",payload:"/help"})},b=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t||!(e.length<1||e.trim().length<1)){if("/help"===e)return v();var a=u.MESSAGE;p.isCommand&&(a=u.COMMAND),null===E||void 0===E||E.emit(a,{message:e,attributes:{draft:t,private:p.private,to:p.to}})}},y="question-circle";p.isCommand?y="code":p.private&&(y="lock");return s.a.createElement(le.a,{noValidate:!0,onSubmit:function(e){e.preventDefault(),p.message.length<1||p.message.trim().length<1||(b(p.message),h((function(e){e.message="",e.private=!1,e.isCommand=!1})))},className:P()(ie.a.textBox,"container",(t={},Object(L.a)(t,ie.a.private,p.private),Object(L.a)(t,ie.a.command,p.isCommand),t))},s.a.createElement(le.a.Group,{controlId:"chatForm.message"},s.a.createElement(le.a.Control,{as:"input",type:"text",placeholder:"Type a message...",autoFocus:!0,onChange:function(e){e.preventDefault(),clearTimeout(g.current);var t=e.currentTarget.value,a=!1,n=!1,s=null;if("/"===t[0])a=!0;else if("@"===t[0]){var r=t.split(" ");n=!0,r.length>0&&"@"===r[0][0]&&d.test(r[0].substr(1))&&(s=r[0].substr(1))}h((function(e){e.message=t,e.private=n,e.to=s,e.isCommand=a})),n||a||l.draftTimer>0&&(g.current=setTimeout((function(){b(t,!0)}),l.draftTimer))},onFocus:a,onBlur:r,value:p.message}),s.a.createElement("div",{className:ie.a.textIcon,onClick:function(){"question-circle"===y&&v()}},s.a.createElement(q.a,{icon:y}))))},me=a(245),de=a.n(me),fe=function(){var e=I().state;return s.a.createElement("div",{className:de.a.onlineUsers},e.onlineUsers.map((function(t){var a,n,r=t.user_id===(null===(a=e.auth.user)||void 0===a?void 0:a.user_id),o="circle";t.icon?o=t.icon:t.user_id===(null===(n=e.auth.user)||void 0===n?void 0:n.user_id)&&(o="dot-circle"),t.isActive||(o="meh");var l=o;return r&&(l=["far",o]),s.a.createElement(V.a,{key:t.user_id,placement:"bottom",overlay:s.a.createElement(J.a,{id:"user-".concat(t.user_id)},"@",t.name)},s.a.createElement("span",{style:{color:"#".concat(t.color)}},s.a.createElement(q.a,{icon:l})))})))},pe=a(538),he=a(72),ge=a.n(he),Ee=a(88),ve=a.n(Ee),be=a(149),ye=a(150),_e=a.n(ye),we="";_e.a.defaults.withCredentials=!0;var ke=function(){var e=Object(be.a)(ve.a.mark((function e(t,a,n){var s,r,o;return ve.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("'url' is required for fetching data");case 2:return s="".concat(m).concat(t),r={url:s,method:a,data:n,timeout:6e3,withCredentials:!0,xsrfHeaderName:"x-csrf-token",headers:{}},we.length>0&&(r.headers["x-csrf-token"]=we),e.prev=5,e.next=8,_e()(r);case 8:return(o=e.sent).headers["x-csrf-token"]&&(we=o.headers["x-csrf-token"]),e.next=12,o.data;case 12:return e.abrupt("return",e.sent);case 15:if(e.prev=15,e.t0=e.catch(5),!e.t0.response){e.next=21;break}throw console.warn("useFetch error on ".concat(a," ").concat(t),e.t0.response),{status:e.t0.response.status,message:Oe(e.t0),errors:Ce(e.t0),data:e.t0.response.data};case 21:throw console.warn("useFetch network error on ".concat(a," ").concat(t),e.t0),{status:500,message:e.t0.message,errors:[e.t0.message]};case 24:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(t,a,n){return e.apply(this,arguments)}}();function Oe(e){return e.response&&e.response.data?Ce(e).join(". "):e.message||"An error occurred"}function Ce(e){return e.response&&e.response.data?function(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t++){var a=t+1<1||arguments.length<=t+1?void 0:arguments[t+1];if(Array.isArray(a))return a;if("string"===typeof a)return[a]}return[e]}("An error occurred",e.response.data,e.response.data.errors,e.response.data.error):[e.message||"An error occurred"]}var xe=function(){var e=I(),t=e.state,a=e.dispatch,r=Object(n.useState)(!1),o=Object(c.a)(r,2),l=o[0],i=o[1],u=Object(n.useState)(!1),d=Object(c.a)(u,2),f=d[0],p=d[1],h=Object(n.useState)(""),g=Object(c.a)(h,2),E=g[0],v=g[1],b=Object(n.useState)(""),y=Object(c.a)(b,2),_=y[0],w=y[1],k=ge.a.unlocked,O="lock-open",C="Set a password to keep your username",x="Claim Username";return t.auth.user&&t.auth.user.hasPassword&&(k=ge.a.locked,O="lock",C="Change your password",x="Update Password"),s.a.createElement("span",{className:ge.a.passwordLock},s.a.createElement(V.a,{placement:"bottom",delay:500,overlay:s.a.createElement(J.a,{id:"passwordLock"},C)},s.a.createElement(K.a,{variant:"link",className:k,style:{padding:0},onClick:function(){return i(!0)}},s.a.createElement(q.a,{icon:O}))),s.a.createElement(pe.a,{show:l,onHide:function(){return i(!1)}},s.a.createElement(le.a,{noValidate:!0,validated:f,onSubmit:function(e){(e.preventDefault(),e.stopPropagation(),p(!0),e.currentTarget.checkValidity())&&ke("/password","POST",{password:E,repeatPassword:_}).then((function(){a({type:"user_password",payload:!0}),i(!1),p(!1),v(""),w("")})).catch((function(e){a({type:"error",payload:e.errors.join(", ")})}))}},s.a.createElement(pe.a.Header,{closeButton:!0},s.a.createElement(pe.a.Title,null,x)),s.a.createElement(pe.a.Body,null,s.a.createElement(le.a.Group,{controlId:"pwd.new"},s.a.createElement(le.a.Control,{as:"input",type:"password",placeholder:"Password...",autoFocus:!0,required:!0,minLength:6,onChange:function(e){v(e.currentTarget.value)},value:E}),s.a.createElement(le.a.Control.Feedback,{type:"invalid"},"The password is too short. Minimum length is 6 characters.")),s.a.createElement(le.a.Group,{controlId:"pwd.new"},s.a.createElement(le.a.Control,{as:"input",type:"password",placeholder:"Repeat Password...",required:!0,minLength:6,pattern:E,onChange:function(e){w(e.currentTarget.value)},value:_}),s.a.createElement(le.a.Control.Feedback,{type:"invalid"},"The passwords don't match!"))),s.a.createElement(pe.a.Footer,{className:ge.a.footer},s.a.createElement("a",{href:"".concat(m,"/logout"),className:P()(ge.a.left,"text-danger")},"Logout"),s.a.createElement(K.a,{type:"submit",variant:"primary"},"Set password")))))},je=function(){var e=A().state,t=Object(Y.a)({isTextBoxFocused:!1,scrollingWhileFocused:!1}),a=Object(c.a)(t,2),r=a[0],o=a[1],i=s.a.createElement(G,null),u=Object(n.useCallback)((function(){o((function(e){e.isTextBoxFocused&&(e.scrollingWhileFocused=!0)}))}),[o]);Object(n.useEffect)((function(){return window.addEventListener("scroll",u,!0),function(){window.removeEventListener("scroll",u)}}),[u]);var m,d={position:"static",top:0};(r.scrollingWhileFocused&&(d.position="absolute",d.top=window.pageYOffset+"px"),e.socket.connected)&&(i=s.a.createElement("div",{className:P()(H.a.chat,Object(L.a)({},H.a.scrollingChat,r.scrollingWhileFocused))},s.a.createElement("div",{className:P()(H.a.header),style:d},s.a.createElement(p.a,null,s.a.createElement(h.a,null,s.a.createElement(g.a,null,s.a.createElement(xe,null),(null===(m=e.auth.user)||void 0===m?void 0:m.isAdmin)&&s.a.createElement(l.b,{to:"/admin",title:"Monitoring",style:{marginLeft:"1em"}},s.a.createElement(q.a,{icon:"shield-alt"}))),s.a.createElement(g.a,null,s.a.createElement(fe,null))))),s.a.createElement(oe,null),s.a.createElement(ue,{onFocus:function(){o((function(e){e.isTextBoxFocused=!0})),u()},onBlur:function(){o((function(e){e.isTextBoxFocused=!1,e.scrollingWhileFocused=!1}))}})));return i},Te=function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement(G,null))},Me=function(e){var t=A().state;return t.auth.checked?t.auth.loggedIn?s.a.createElement(F.b,{path:e.path,exact:e.exact,component:e.component}):s.a.createElement(F.a,{to:"/login"}):s.a.createElement(Te,null)},Se=function(e){var t=A().state;return t.auth.checked?t.auth.loggedIn?s.a.createElement(F.a,{to:"/"}):s.a.createElement(F.b,{path:e.path,exact:e.exact,component:e.component}):s.a.createElement(Te,null)},Ne=a(153),Ae=a.n(Ne),Ie=function(){var e=A().state;if(!e.offline&&!e.error)return null;var t=e.error;return Array.isArray(t)&&(t=t.join(". ")),"string"!==typeof t&&(t=String(t)),e.error?s.a.createElement("div",{className:Ae.a.offline},"Error: ",t):s.a.createElement("div",{className:Ae.a.offline},"You seem to be offline! Please try again later")},Fe=(a(247),a(252)),Le=a(248),Ue=a.n(Le),Pe=function(){var e=A().dispatch,t=Object(Y.a)({username:"",password:"",verified:!1,hasPassword:!1,loading:!1}),a=Object(c.a)(t,2),r=a[0],o=a[1],l=Object(n.useRef)(null),i=function(t){if(t&&!r.loading){o((function(e){e.loading=!0}));var a={username:r.username,password:r.password,captchaToken:t};ke("/auth","POST",a).then((function(t){if(l.current.resetCaptcha&&l.current.resetCaptcha(),!t||!t.user.user_id)return console.warn("Invalid user object"),void e({type:"login",payload:null});e({type:"login",payload:t})})).catch((function(t){400!==t.status&&e({type:"error",payload:t.errors.join(", ")}),l.current.resetCaptcha&&l.current.resetCaptcha(),o((function(e){e.loading=!1,e.verified=t.data&&t.data.verified||!1,400===t.status&&(e.hasPassword=!0)}))}))}},u="light";return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(u="dark"),s.a.createElement(p.a,{className:P()(Ue.a.login,"mt-4")},s.a.createElement(D,null),s.a.createElement(le.a,{noValidate:!0,onSubmit:function(e){e.preventDefault(),r.verified?i("verified"):l.current.execute()}},s.a.createElement(le.a.Group,{controlId:"loginForm.username"},s.a.createElement(le.a.Control,{as:"input",type:"text",placeholder:"What's your name?",disabled:r.loading,autoFocus:!0,minLength:1,maxLength:20,onChange:function(e){var t=e.currentTarget.value;o((function(e){e.username=t}))},value:r.username}),r.hasPassword&&s.a.createElement(le.a.Control,{as:"input",className:"mt-2",type:"password",placeholder:"Password...",disabled:r.loading,autoFocus:!0,onChange:function(e){var t=e.currentTarget.value;o((function(e){e.password=t}))},value:r.password}),s.a.createElement(Fe.a,{ref:l,size:"invisible",theme:u,sitekey:f,onChange:i}),!1,s.a.createElement("button",{type:"submit",style:{visibility:"hidden"}},"Login"))))},Be=function e(t){ke("/auth","GET").then((function(e){if(!e||!e.user.user_id)return console.warn("Invalid user object"),void t({type:"login",payload:null});t({type:"login",payload:e})})).catch((function(a){"Network Error"===a.message?(t({type:"offline",payload:null}),setTimeout((function(){e(t)}),2e3)):(401!==a.status&&t({type:"error",payload:a.errors.join(", ")}),t({type:"login",payload:null}))}))},Re=function(){var e=I(),t=e.state,a=e.dispatch;return Object(n.useEffect)((function(){t.auth.checked||Be(a)}),[t.auth.checked,a]),s.a.createElement(s.a.Fragment,null,s.a.createElement(Ie,null),s.a.createElement(F.d,null,s.a.createElement(Se,{path:"/login",component:Pe}),s.a.createElement(Me,{path:"/admin",component:x}),s.a.createElement(Me,{path:"/",component:je})))},De=a(249),Ge=a.n(De),ze=a(250),He=a(251),Ke=a.n(He),Ye=function(){var e=I().state,t=Object(Y.a)({lastSound:new Date,windowFocused:!0,titleNotification:!1}),a=Object(c.a)(t,2),r=a[0],o=a[1],l=Object(n.useContext)(k).socket,i=Object(ze.a)(Ke.a,{interrupt:!0,volume:.5}),u=Object(c.a)(i,1)[0],m=Object(n.useCallback)((function(e){return function(t){t.attributes.draft||e===t.user.user_id||o((function(e){e.windowFocused||(e.titleNotification=!0,(!e.lastSound||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;return t.getTime()-e.getTime()}(e.lastSound)>5e3)&&(e.lastSound=new Date,u({})))}))}}),[o,u]),d=Object(n.useCallback)((function(){o((function(e){e.titleNotification=!1,e.windowFocused=!0}))}),[o]),f=Object(n.useCallback)((function(){o((function(e){e.windowFocused=!1}))}),[o]),p=e.auth.user?e.auth.user.user_id:null;return Object(n.useEffect)((function(){l&&p&&l.on("message",m(p))}),[l,m,p]),Object(n.useEffect)((function(){return window.addEventListener("focus",d),window.addEventListener("blur",f),function(){window.removeEventListener("focus",d),window.removeEventListener("blur",f)}}),[d,f]),s.a.createElement(Ge.a,null,s.a.createElement("title",null,r.titleNotification?"\u2022\u2022 dotdot":"dotdot"))},We=a(78),Ze=a(9),qe=a(11);We.b.add(Ze.G,Ze.H,Ze.c,Ze.h,qe.c,Ze.d,Ze.e,Ze.f,Ze.b,Ze.I,qe.B,Ze.a,Ze.g,Ze.i,Ze.j,Ze.k,Ze.l,Ze.m,Ze.n,Ze.o,Ze.p,Ze.q,Ze.r,Ze.s,Ze.t,Ze.u,Ze.v,Ze.w,Ze.x,Ze.y,Ze.z,Ze.A,Ze.B,Ze.C,Ze.D,Ze.E,Ze.F,Ze.J,Ze.K,Ze.M,Ze.N,Ze.P,Ze.Q,Ze.R,Ze.S,Ze.T,qe.a,qe.b,qe.d,qe.e,qe.f,qe.g,qe.h,qe.i,qe.j,qe.k,qe.l,qe.m,qe.n,qe.o,qe.p,qe.q,qe.r,qe.s,qe.t,qe.u,qe.v,qe.w,qe.x,qe.y,qe.z,qe.A,qe.C,qe.D,qe.E,qe.F,qe.G,qe.H,qe.I,qe.J,qe.K,Ze.O,Ze.L);a(525);var Ve=s.a.createElement(l.a,{basename:"/"},s.a.createElement(N,null,s.a.createElement(O,null,s.a.createElement(Ye,null),s.a.createElement(Re,null))));o.a.render(Ve,document.getElementById("root"))},72:function(e,t,a){e.exports={passwordLock:"PasswordLock_passwordLock__2FTiA",unlocked:"PasswordLock_unlocked__21MTQ",pulse:"PasswordLock_pulse__2T-_F",locked:"PasswordLock_locked__1mCl-",footer:"PasswordLock_footer__3PO9z",left:"PasswordLock_left__3Gmj3"}},85:function(e,t,a){e.exports={logo:"Logo_logo__30xDu",svgFilter:"Logo_svgFilter__1s9i7",blob:"Logo_blob__1iSwo","blob-first":"Logo_blob-first__3YKrD","blob-second":"Logo_blob-second__2r5Nx"}},86:function(e,t,a){e.exports={messages:"Messages_messages__tCmp1",messageScroll:"Messages_messageScroll__CCnSp",unseen:"Messages_unseen__gVw6f",unseenContainer:"Messages_unseenContainer__3haBw"}},87:function(e,t,a){e.exports={textBox:"TextBox_textBox__McZeC",textIcon:"TextBox_textIcon__mlsnG",private:"TextBox_private__1kesE",command:"TextBox_command__1uXWO"}}},[[280,1,2]]]);
//# sourceMappingURL=main.4ad742e9.chunk.js.map