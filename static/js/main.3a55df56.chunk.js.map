{"version":3,"sources":["sections/Chat/TextBox/index.module.scss","sections/Chat/PasswordLock/index.module.scss","components/OfflineCheck/index.module.scss","sections/Chat/index.module.scss","sections/Chat/OnlineUsers/index.module.scss","sections/Login/index.module.scss","assets/sounds/newMessage.mp3","sections/Chat/Messages/Message/index.module.scss","store/types.ts","constants.ts","sections/Admin/RealtimeChart/index.tsx","lib/secondsToHuman.ts","sections/Admin/index.tsx","store/reducer.ts","store/state.tsx","util/socketProvider.tsx","components/Logo/index.tsx","components/Loader/index.tsx","sections/Chat/Messages/Message/index.tsx","sections/Chat/Messages/ScrollBox/index.tsx","sections/Chat/Messages/index.tsx","sections/Chat/TextBox/index.tsx","sections/Chat/OnlineUsers/index.tsx","util/fetch.ts","sections/Chat/PasswordLock/index.tsx","sections/Chat/index.tsx","sections/loading/index.tsx","util/AuthenticatedRoute.tsx","util/UnauthenticatedRoute.tsx","components/OfflineCheck/index.tsx","sections/Login/index.tsx","util/checkAuth.ts","router.tsx","components/Title/index.tsx","lib/dateDiff.ts","lib/icons.ts","index.tsx","components/Logo/index.module.scss","sections/Chat/Messages/index.module.scss"],"names":["module","exports","EVENTS","CONNECT","DISCONNECT","MESSAGE","COMMAND","HISTORY","ONLINE_USERS","STATS","TIMER","CONTROL","API_URL","process","VALID_USERNAME","props","data","map","num","index","date","value","i","length","MAX_STATS_BARS","push","style","width","height","barSize","barCategoryGap","barGap","margin","top","bottom","left","right","allowDecimals","dataKey","tick","label","position","offset","fill","stroke","isAnimationActive","type","cursor","forHumans","seconds","levels","Math","floor","returntext","max","substr","trim","state","useGlobalState","tableData","header","stats","onlineUsers","round","totalUsers","totalMessages","cpuUsage","freeMemory","uptime","timeActive","sessions","timeInactive","roomData","rooms","Container","fluid","Row","Col","RealtimeChart","messages","users","domain","stackId","Table","size","variant","className","row","key","produce","draft","action","offline","auth","checked","payload","loggedIn","user","error","socket","connected","hasPassword","message","existingDraft","findIndex","eachMessage","attributes","user_id","splice","lastMessage","private","timestamp","Date","shift","Object","keys","forEach","initialState","draftTimer","Array","StateContext","React","createContext","dispatch","console","warn","StateProvider","useReducer","reducer","Provider","children","useContext","SocketContext","useState","setSocket","useEffect","newSocket","socketio","reconnection","timeout","setInterval","emit","values","event","on","provider","infinite","animationIterationCount","animationDirection","styles","logo","blob","svgFilter","xmlns","version","id","in","stdDeviation","result","mode","in2","Logo","userData","find","userColor","color","isSystem","isUserOnline","isActive","iconName","icon","reactStringReplace","username","userIndex","name","mention","classNames","system","toDateString","background","OverlayTrigger","placement","overlay","Tooltip","spin","toLocaleTimeString","hour","minute","body","boxRef","onScrollChanged","threshold","scrollTop","setScrollTop","setHeight","scrollDebounce","useRef","onScrollDebounced","useCallback","isAtBottom","clearTimeout","current","setTimeout","scrollToBottom","scrollHeight","offsetHeight","updateScrollState","shouldScroll","customThreshold","abs","window","addEventListener","removeEventListener","newHeight","useImmer","scrollAtBottom","unseenMessages","localState","setLocalState","chatAreaRef","unseen","unseenContainer","Button","onClick","messageScroll","ref","ScrollBox","Message","getTime","to","isCommand","setState","sendMessage","Form","noValidate","onSubmit","e","preventDefault","textBox","command","Group","controlId","Control","as","placeholder","autoFocus","onChange","currentTarget","isPM","words","split","test","isCurrentUser","csrfToken","axios","defaults","withCredentials","fetchResource","path","method","a","Error","url","options","xsrfHeaderName","headers","response","status","parseAxiosError","errors","parseErrorList","join","defaultError","isArray","parseErrors","useFetch","showModal","setShowModal","validated","setValidated","password","setPassword","repeatPassword","setRepeatPassword","handleClose","buttonClass","unlocked","buttonIcon","tooltipText","title","locked","passwordLock","delay","padding","Modal","show","onHide","stopPropagation","checkValidity","then","catch","reason","Header","closeButton","Title","Body","required","minLength","Feedback","pattern","Footer","href","chatArea","Loader","chat","PasswordLock","isAdmin","marginLeft","OnlineUsers","Messages","TextBox","exact","component","String","verified","loading","captchaRef","oncaptchaChange","token","captchaToken","resetCaptcha","theme","matchMedia","matches","login","execute","disabled","maxLength","sitekey","onVerify","visibility","checkAuth","OfflineCheck","UnauthenticatedRoute","Login","AuthenticatedRoute","Admin","Chat","lastSound","windowFocused","titleNotification","useSound","newMessageSound","interrupt","volume","play","onMessage","msg","t1","t2","dateDiff","onFocus","onBlur","library","add","faLock","faLockOpen","faCircle","faDotCircle","farDotCircle","faCircleNotch","faCode","faCog","faArrowAltCircleDown","faMeh","farMeh","faAngry","faDizzy","faFlushed","faFrown","faFrownOpen","faGrimace","faGrin","faGrinAlt","faGrinBeam","faGrinBeamSweat","faGrinHearts","faGrinSquint","faGrinSquintTears","faGrinStars","faGrinTears","faGrinTongue","faGrinTongueSquint","faGrinTongueWink","faGrinWink","faKiss","faKissBeam","faKissWinkHeart","faLaugh","faLaughBeam","faLaughSquint","faLaughWink","faMehBlank","faMehRollingEyes","faSadCry","faSadTear","faSmile","faSmileBeam","faSmileWink","faSurprise","faTired","farAngry","farDizzy","farFlushed","farFrown","farFrownOpen","farGrimace","farGrin","farGrinAlt","farGrinBeam","farGrinBeamSweat","farGrinHearts","farGrinSquint","farGrinSquintTears","farGrinStars","farGrinTears","farGrinTongue","farGrinTongueSquint","farGrinTongueWink","farGrinWink","farKiss","farKissBeam","farKissWinkHeart","farLaugh","farLaughBeam","farLaughSquint","farLaughWink","farMehBlank","farMehRollingEyes","farSadCry","farSadTear","farSmile","farSmileBeam","farSmileWink","farSurprise","farTired","faShieldAlt","app","basename","ReactDOM","render","document","getElementById"],"mappings":"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CAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,KACAC,M,WCxKIC,GACJ,kBAAC,IAAD,CAAeC,SAAUnb,KACvB,kBAAC,EAAD,KACE,kBAAC,EAAD,KACE,kBAACmS,GAAD,MACA,kBAAC,GAAD,SAMRiJ,IAASC,OAAOH,GAAKI,SAASC,eAAe,U,mBCxB7Cpc,EAAOC,QAAU,CAAC,KAAO,mBAAmB,UAAY,wBAAwB,KAAO,mBAAmB,aAAa,yBAAyB,cAAc,4B,mBCA9JD,EAAOC,QAAU,CAAC,SAAW,2BAA2B,cAAgB,gCAAgC,OAAS,yBAAyB,gBAAkB,qC","file":"static/js/main.3a55df56.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"textBox\":\"TextBox_textBox__McZeC\",\"private\":\"TextBox_private__1kesE\",\"command\":\"TextBox_command__1uXWO\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"passwordLock\":\"PasswordLock_passwordLock__2FTiA\",\"unlocked\":\"PasswordLock_unlocked__21MTQ\",\"pulse\":\"PasswordLock_pulse__2T-_F\",\"locked\":\"PasswordLock_locked__1mCl-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"offline\":\"OfflineCheck_offline__2vKbm\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"chat\":\"Chat_chat__LEZtX\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"onlineUsers\":\"OnlineUsers_onlineUsers__2Umxk\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"login\":\"Login_login__38Hzs\"};","module.exports = __webpack_public_path__ + \"static/media/newMessage.482e2f99.mp3\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"message\":\"Message_message__2v30T\",\"mention\":\"Message_mention__82QFp\",\"system\":\"Message_system__2g6ZE\",\"user\":\"Message_user__3HofW\",\"timestamp\":\"Message_timestamp__2armv\",\"offline\":\"Message_offline__32gHu\",\"icon\":\"Message_icon__ATXFm\",\"body\":\"Message_body__32TEj\",\"draft\":\"Message_draft__1zB7h\",\"header\":\"Message_header__3wUCX\",\"private\":\"Message_private__ORZ48\"};","import { IconName } from \"@fortawesome/fontawesome-svg-core\"\n\nexport type User = {\n  user_id: string\n  name: string\n  color: string\n  icon: IconName | null\n  isActive: boolean\n  isAdmin?: boolean\n  hasPassword: boolean\n}\n\nexport type Message = {\n  user: User\n  timestamp: Date\n  message: string\n  attributes: {\n    draft: boolean\n    private: boolean\n    to?: string | null\n  }\n}\n\nexport type RoomStats = {\n  active: number,\n  inactive: number,\n}\n\nexport type AppState = {\n  auth: {\n    checked: boolean\n    loggedIn: boolean\n    user: User | null\n  }\n  socket: {\n    connected: boolean\n  }\n  draftTimer: number,\n  onlineUsers: User[]\n  messages: Message[]\n  stats: {\n    messages: number[],\n    users: number[],\n    rooms: RoomStats[],\n    onlineUsers: number,\n    totalMessages: number,\n    totalUsers: number,\n    cpuUsage: number,\n    freeMemory: number,\n    uptime: number,\n    timeActive: number,\n    timeInactive: number,\n    sessions: number,\n  }\n  offline: boolean\n  error: string | null\n\n  [key: string]: any\n}\n\nexport type Action = {\n  type: string\n  payload?: any\n}\n\nexport type AppContext = {\n  state: AppState\n  dispatch: React.Dispatch<Action>\n}\n\nexport type AuthData = {\n  user: User\n  token: string\n}\n\nexport const EVENTS = {\n  CONNECT: 'connect',\n  DISCONNECT: 'disconnect',\n  MESSAGE: 'message',\n  COMMAND: 'command',\n  HISTORY: 'history',\n  ONLINE_USERS: 'users',\n  STATS: 'stats',\n  TIMER: 'timer',\n  CONTROL: 'control',\n};","export const API_URL = process.env.REACT_APP_API_URL || 'https://api.dotdot.im'\nexport const VALID_USERNAME = /^[A-Za-z0-9]+(?:[ _][A-Za-z0-9]+)*_?$/i\nexport const CAPTCHA_KEY = process.env.REACT_APP_CAPTCHA_KEY || ''\nexport const MAX_MESSAGE_HISTORY = 100\n","import React from 'react'\nimport { AreaChart, XAxis, YAxis, Area, Tooltip, ResponsiveContainer, Label } from 'recharts'\nimport { MAX_STATS_BARS } from '..';\n\ntype Props = {\n  data: number[],\n  height?: number,\n  label: string,\n};\n\nexport default (props: Props) => {\n  const data = props.data.map((num, index) => ({\n    date: index,\n    value: num,\n  }))\n\n  for (let i = data.length; i < MAX_STATS_BARS; i++) {\n    data.push({\n      date: i,\n      value: 0,\n    })\n  }\n\n  return (\n    <div style={ { width: '100%', height: `${ props.height || 250 }px` } }>\n      <ResponsiveContainer>\n        <AreaChart data={data} barSize={ 5 } barCategoryGap={ 2 } barGap={ 2 } margin={{ top: 50, bottom: 20, left: 0, right: 0}}>\n          <YAxis allowDecimals={ false } />\n          <XAxis dataKey=\"date\" tick={false}>\n            <Label value={ props.label } position=\"bottom\" offset={ -15 } fill='#ccc' />\n          </XAxis>\n          <Area dataKey=\"value\" fill=\"#f75f00\" stroke=\"#f75f00\" isAnimationActive={ false } type='linear' />\n          <Tooltip cursor={ { fill: 'rgba(255, 255, 255, 0.1)' } }/>\n        </AreaChart>\n      </ResponsiveContainer>\n    </div>\n  )\n}","export function forHumans ( seconds: number ) {\n  const levels: [number, string][] = [\n      [Math.floor(seconds / 31536000), 'years'],\n      [Math.floor((seconds % 31536000) / 86400), 'days'],\n      [Math.floor(((seconds % 31536000) % 86400) / 3600), 'hours'],\n      [Math.floor((((seconds % 31536000) % 86400) % 3600) / 60), 'minutes'],\n      [(((seconds % 31536000) % 86400) % 3600) % 60, 'seconds'],\n  ];\n  let returntext = '';\n\n  for (let i = 0, max = levels.length; i < max; i++) {\n      if ( levels[i][0] === 0 ) continue;\n      returntext += ' ' + levels[i][0] + ' ' + (levels[i][0] === 1 ? levels[i][1].substr(0, levels[i][1].length-1): levels[i][1]);\n  };\n  return returntext.trim();\n}","import React from 'react'\nimport { Container, Row, Col, Table } from 'react-bootstrap'\nimport { BarChart, XAxis, YAxis, Bar, Tooltip, ResponsiveContainer, Label } from 'recharts'\n\nimport useGlobalState from 'store/state';\nimport RealtimeChart from './RealtimeChart';\nimport { forHumans } from 'lib/secondsToHuman';\n\nexport const MAX_STATS_BARS = 100;\n\nexport default () => {\n  const { state } = useGlobalState()\n\n  const tableData = [\n    {\n      header: 'Users Online',\n      data: `${state.stats.onlineUsers}  (${Math.round(state.stats.onlineUsers * 100 / state.stats.totalUsers)}%)`,\n    },\n    {\n      header: 'Total Users',\n      data: state.stats.totalUsers,\n    },\n    {\n      header: 'Total Messages',\n      data: state.stats.totalMessages,\n    },\n    {\n      header: 'CPU Usage',\n      data: state.stats.cpuUsage + '%',\n    },\n    {\n      header: 'Free Memory',\n      data: state.stats.freeMemory + '%',\n    },\n    {\n      header: 'Server Uptime',\n      data: forHumans(state.stats.uptime),\n    },\n    {\n      header: 'Time Active / Ses',\n      data: forHumans(Math.round(state.stats.timeActive / state.stats.sessions)),\n    },\n    {\n      header: 'Time Inactive / Sess',\n      data: forHumans(Math.round(state.stats.timeInactive / state.stats.sessions)),\n    },\n    {\n      header: 'Total Sessions',\n      data: state.stats.sessions,\n    },\n    {\n      header: 'Avg Sessions / user',\n      data: Math.round(state.stats.sessions / state.stats.totalUsers),\n    },\n    {\n      header: 'Total Time Active',\n      data: forHumans(state.stats.timeActive),\n    },\n    {\n      header: 'Total Time Inactive',\n      data: forHumans(state.stats.timeInactive),\n    },\n  ]\n\n  const roomData = state.stats.rooms\n\n  return (\n    <Container fluid>\n      <Row>\n        <Col>\n          <RealtimeChart\n            data={ state.stats.messages }\n            label='Realtime Messages'\n          />\n        </Col>\n        <Col>\n          <RealtimeChart\n            data={ state.stats.users }\n            label='Realtime Users'\n          />\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <div style={ { width: '100%', height: '400px' } }>\n            <ResponsiveContainer>\n              <BarChart data={roomData} barSize={ 10 } margin={{ top: 50, bottom: 0, left: 0, right: 0}}>\n                <YAxis allowDecimals={ false } domain={ [ 0, 10 ] } />\n                <XAxis tick={false}>\n                  <Label value='Rooms' position=\"bottom\" offset={ -15 } fill='#ccc' />\n                </XAxis>\n                <Bar dataKey=\"active\" stackId='a' fill=\"#f75f00\" />\n                <Bar dataKey=\"inactive\" stackId='a' fill=\"#555\" />\n                <Tooltip cursor={ { fill: 'rgba(255, 255, 255, 0.1)' } }/>\n              </BarChart>\n            </ResponsiveContainer>\n          </div>\n        </Col>\n      </Row>\n      <Container>\n        <Row>\n          <Col>\n            <Table size='sm' variant=\"dark\" className='mt-4'>\n              <tbody>\n                { tableData.map(row => (\n                  <tr key={ row.header }>\n                    <th style={ { width: '230px' } }>\n                      { row.header }\n                    </th>\n                    <td>\n                      { row.data }\n                    </td>\n                  </tr>\n                )) }\n              </tbody>\n            </Table>\n          </Col>\n        </Row>\n      </Container>\n    </Container>\n  )\n}","import produce from 'immer'\n\nimport { AppState, Action, Message, EVENTS } from './types'\nimport { MAX_MESSAGE_HISTORY } from '../constants'\nimport { MAX_STATS_BARS } from 'sections/Admin'\n\n// TODO NEW BLOG POST\n// const REDUCER = {\n//   [REDUX_CONSTANTS.LOGIN]: (draft, payload) => {},\n// };\n\nexport default produce((draft: AppState, action: Action) => {\n  // REDUCER[action.type](draft, action.payload);\n  // console.log('REDUCER', action)\n\n  switch (action.type) {\n    case 'login':\n      if (!draft.offline) {\n        draft.auth.checked = true\n      }\n\n      if (!action.payload) {\n        draft.auth.loggedIn = false\n        draft.auth.user = null\n        break\n      }\n\n      draft.offline = false\n\n      draft.auth.loggedIn = true\n      draft.auth.user = action.payload.user\n      break\n    case 'offline':\n      draft.offline = true\n      draft.error = null\n      draft.socket.connected = false\n      break\n    case 'error':\n      draft.error = action.payload\n      break\n    case 'user_password':\n      if (draft.auth.user) {\n        draft.auth.user.hasPassword = true\n      }\n      break\n    case `socket_${EVENTS.CONNECT}`:\n      draft.socket.connected = true\n      draft.offline = false\n      draft.error = null\n      break\n    case `socket_${EVENTS.DISCONNECT}`:\n      draft.socket.connected = false\n      draft.offline = true\n      draft.error = null\n      break\n    case `socket_${EVENTS.ONLINE_USERS}`:\n      draft.onlineUsers = action.payload.users\n      break\n    case `socket_${EVENTS.MESSAGE}`:\n      const message: Message = action.payload\n      // delete draft from this user\n      const existingDraft = draft.messages.findIndex(\n        (eachMessage) =>\n          eachMessage.attributes.draft &&\n          eachMessage.user.user_id === message.user.user_id\n      )\n      if (existingDraft > -1) {\n        draft.messages.splice(existingDraft, 1)\n      }\n\n      if (message.message.trim().length < 1) {\n        return;\n      }\n\n      if (!message.attributes.draft) {\n        const lastMessage = draft.messages[draft.messages.length - 1]\n\n        if (lastMessage && lastMessage.user.user_id === message.user.user_id && lastMessage.attributes.private === message.attributes.private) {\n          // last message was by this same user (and it's the same kind of message)\n          lastMessage.message += `\\n${message.message}`\n          lastMessage.timestamp = new Date(message.timestamp)\n          return\n        }\n      }\n\n      draft.messages.push({\n        timestamp: new Date(message.timestamp),\n        attributes: message.attributes,\n        message: message.message,\n        user: message.user,\n      })\n\n      if (draft.messages.length > MAX_MESSAGE_HISTORY) {\n        draft.messages.shift()\n      }\n      break;\n    case `socket_${EVENTS.HISTORY}`:\n      draft.messages = action.payload.map((eachMessage: Message) => {\n        eachMessage.timestamp = new Date(eachMessage.timestamp)\n        return eachMessage\n      });\n      break;\n    case `socket_${EVENTS.STATS}`:\n      draft.stats.messages.push(action.payload.messages)\n      if (draft.stats.messages.length > MAX_STATS_BARS) {\n        draft.stats.messages.shift()\n      }\n\n      draft.stats.users.push(action.payload.users)\n      if (draft.stats.users.length > MAX_STATS_BARS) {\n        draft.stats.users.shift()\n      }\n\n      draft.stats.rooms = action.payload.rooms\n      draft.stats.onlineUsers = action.payload.users\n      draft.stats.totalUsers = action.payload.totalUsers\n      draft.stats.totalMessages = action.payload.totalMessages\n      draft.stats.cpuUsage = Math.round(action.payload.cpuUsage * 100)\n      draft.stats.freeMemory = Math.round(action.payload.freeMemory * 100)\n      draft.stats.uptime = Math.round(action.payload.uptime)\n      draft.stats.timeActive = action.payload.timeActive * 30\n      draft.stats.timeInactive = action.payload.timeInactive * 30\n      draft.stats.sessions = action.payload.sessions\n      break;\n    case `socket_${EVENTS.CONTROL}`:\n      Object.keys(action.payload).forEach(key => {\n        if (typeof draft[key] !== 'undefined') {\n          draft[key] = action.payload[key]\n        }\n      })\n  }\n})\n","import React from 'react'\n\nimport reducer from './reducer'\nimport { AppState, AppContext, Action } from './types'\nimport { MAX_STATS_BARS } from 'sections/Admin'\n\nexport const initialState: AppState = {\n  auth: {\n    checked: false,\n    loggedIn: false,\n    user: null,\n  },\n  socket: {\n    connected: false,\n  },\n  draftTimer: 100,\n  onlineUsers: [],\n  messages: [],\n  stats: {\n    messages: new Array(MAX_STATS_BARS).fill(0),\n    users: new Array(MAX_STATS_BARS).fill(0),\n    rooms: [],\n    onlineUsers: 0,\n    totalUsers: 0,\n    totalMessages: 0,\n    cpuUsage: 0,\n    freeMemory: 0,\n    uptime: 0,\n    timeActive: 0,\n    timeInactive: 0,\n    sessions: 1,\n  },\n  offline: false,\n  error: null,\n}\nconst defaultDispatch: React.Dispatch<Action> = () => {\n  console.warn('Using default reducer, check StateProvider')\n  return initialState\n}\nexport const StateContext = React.createContext<AppContext>({\n  state: initialState,\n  dispatch: defaultDispatch,\n})\n\ntype Props = {\n  state?: AppState,\n  children: any\n}\n\nexport const StateProvider = (props: Props) => {\n  const [state, dispatch] = React.useReducer(reducer, props.state || initialState)\n  // TODO: if value is not \"any\" then typescript has an issue with readonly state values\n  const value: any = { state, dispatch }\n  return (\n    <StateContext.Provider value={value}>\n      {props.children}\n    </StateContext.Provider>\n  )\n}\n\nexport const useGlobalState = (): AppContext => React.useContext(StateContext)\nexport default useGlobalState\n","import React, { createContext, useEffect, useState } from 'react'\nimport socketio from 'socket.io-client'\n\nimport { useGlobalState } from 'store/state'\nimport { API_URL } from '../constants'\nimport { Message, EVENTS } from 'store/types'\n\nconst USAGE_TIMER_INTERAL = 30 * 1000\n\ntype SocketContextType = {\n  socket: SocketIOClient.Socket | null\n}\n\nexport const SocketContext = createContext<SocketContextType>({\n  socket: null,\n})\n\ntype Props = {\n  children: any\n}\n\nexport default (props: Props) => {\n  const { state, dispatch } = useGlobalState()\n  const [socket, setSocket] = useState<SocketIOClient.Socket | null>(null)\n\n  useEffect(() => {\n    // clear any errors\n    dispatch({\n      type: 'error',\n      payload: null,\n    })\n\n    if (!state.auth.loggedIn) {\n      return\n    }\n\n    // initialize the socket\n    const newSocket = socketio(API_URL, {\n      reconnection: true,\n      timeout: 2000,\n    })\n\n    setInterval(() => {\n      if (newSocket.connected) {\n        newSocket.emit('timer')\n      }\n    }, USAGE_TIMER_INTERAL)\n\n    Object.values(EVENTS).forEach(event => {\n      newSocket.on(event, (payload: any) => {\n        dispatch({\n          type: `socket_${event}`,\n          payload: payload,\n        })\n      })\n    })\n\n    newSocket.on('stats', (payload: Message[]) => {\n      dispatch({\n        type: 'stats',\n        payload,\n      })\n    })\n\n    newSocket.on('connect_error', () => {\n      dispatch({\n        type: 'offline',\n        payload: null,\n      })\n    })\n\n    newSocket.on('connect_timeout', () => {\n      dispatch({\n        type: 'offline',\n        payload: null,\n      })\n    })\n\n    newSocket.on('error', (error: string) => {\n      dispatch({\n        type: 'socketConnected',\n        payload: false,\n      })\n\n      if (error) {\n        dispatch({\n          type: 'error',\n          payload: error,\n        })\n        dispatch({\n          type: 'login',\n          payload: null,\n        })\n      } else {\n        dispatch({\n          type: 'offline',\n          payload: null,\n        })\n      }\n    })\n\n    setSocket(newSocket)\n  }, [dispatch, state.auth.loggedIn])\n\n  let provider = {\n    socket,\n  }\n\n  return (\n    <SocketContext.Provider value={provider}>\n      {props.children}\n    </SocketContext.Provider>\n  )\n}\n","import React from 'react'\n\nimport styles from './index.module.scss'\n\ntype Props = {\n  infinite?: boolean\n}\n\nexport default (props: Props) => {\n  const style: any = {}\n  if (props.infinite) {\n    style.animationIterationCount = 'infinite'\n    style.animationDirection = 'alternate'\n  }\n  return (\n    <>\n      <div className={styles.logo}>\n        <div className={styles.blob} style={style}></div>\n        <div className={styles.blob} style={style}></div>\n      </div>\n\n      <svg\n        className={styles.svgFilter}\n        xmlns=\"http://www.w3.org/2000/svg\"\n        version=\"1.1\"\n      >\n        <defs>\n          <filter id=\"goo\">\n            <feGaussianBlur\n              in=\"SourceGraphic\"\n              stdDeviation=\"10\"\n              result=\"blur\"\n            />\n            <feColorMatrix\n              in=\"blur\"\n              mode=\"matrix\"\n              values=\"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7\"\n              result=\"goo\"\n            />\n            <feBlend in=\"SourceGraphic\" in2=\"goo\" />\n          </filter>\n        </defs>\n      </svg>\n    </>\n  )\n}\n","import React from 'react'\nimport Logo from 'components/Logo'\n\ntype Props = {\n  text?: string | null\n}\n\nexport default (props: Props) => {\n  return (\n    <>\n      <Logo infinite />\n    </>\n  )\n}\n","import React from 'react'\nimport classNames from 'classnames'\nimport reactStringReplace from 'react-string-replace'\nimport { IconProp, IconName } from '@fortawesome/fontawesome-svg-core'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { OverlayTrigger, Tooltip } from 'react-bootstrap'\n\nimport { Message } from 'store/types'\nimport styles from './index.module.scss'\nimport useGlobalState from 'store/state'\n\ntype Props = {\n  message: Message\n}\n\nexport default (props: Props) => {\n  const { state } = useGlobalState()\n\n  // User data comes from online users if available\n  const userData = state.onlineUsers.find(\n    user => user.user_id === props.message.user.user_id\n  ) || props.message.user\n\n  const userColor = `#${userData.color}`\n  const isSystem = userData.user_id === 'dotdot'\n  const isUserOnline = isSystem || (state.onlineUsers.findIndex(user => user.user_id === userData.user_id) > -1 && userData.isActive)\n\n  let iconName: IconName = 'circle'\n  if (userData.icon) {\n    iconName = userData.icon\n  } else if (userData.user_id === state.auth.user?.user_id) {\n    iconName = 'dot-circle'\n  }\n\n  // special icons\n  if (isSystem) {\n    iconName = 'cog'\n  } else if (props.message.attributes.draft) {\n    iconName = 'circle-notch'\n  } else if (props.message.attributes.private) {\n    iconName = 'lock'\n  } else if (!isUserOnline) {\n    iconName = 'meh'\n  }\n\n  let icon: IconProp = iconName\n  if (userData.user_id === state.auth.user?.user_id) {\n    icon = ['far', iconName]\n  }\n\n  // replace mentions with colored version\n  const message = reactStringReplace(props.message.message, /@([A-Za-z0-9]+(?:[_][A-Za-z0-9]+)*_?)/gmi, (username, index) => {\n    let style = {}\n    const userIndex = state.onlineUsers.findIndex(user => user.name === username)\n    if (userIndex > -1) {\n      style = {\n        color: `#${state.onlineUsers[userIndex].color}`\n      }\n    }\n    return (\n      <span key={index} className={ styles.mention } style={ style }>\n        @{username}\n      </span>\n    );\n  })\n\n  return (\n    <div\n      className={classNames(styles.message, {\n        [styles.system]: isSystem,\n        [styles.offline]: !isUserOnline,\n        [styles.draft]: props.message.attributes.draft,\n        [styles.private]: props.message.attributes.private,\n      })}\n      key={props.message.timestamp.toDateString()}\n    >\n      <div className={classNames(styles.icon, { [styles.private]: props.message.attributes.private })} style={{ color: userColor, background: userColor }}>\n        { props.message.attributes.private && (\n          <OverlayTrigger\n            placement=\"right\"\n            overlay={(\n              <Tooltip id={`user-${userData.user_id}`}>\n                Private message from <b>@{userData.name}</b><br />\n                Only you can see this.\n              </Tooltip>\n            )}\n          >\n            <FontAwesomeIcon icon={ icon } />\n          </OverlayTrigger>\n        ) }\n        { !props.message.attributes.private && (\n          <FontAwesomeIcon icon={ icon } spin={ props.message.attributes.draft } />\n        ) }\n      </div>\n      <div className={classNames(styles.timestamp)}>\n        {props.message.attributes.draft ? 'now' : props.message.timestamp.toLocaleTimeString([], { hour: 'numeric', minute: '2-digit' })}\n      </div>\n      <span\n        className={classNames(styles.user)}\n        style={ { color: userColor } }\n      >\n        {userData.name}\n      </span>\n      <div className={classNames(styles.body)}>\n        {message}\n      </div>\n    </div>\n  )\n}\n","import React, { useEffect, useCallback, useState, useRef } from 'react'\n\nconst SCROLL_THRESHOLD = 100\nconst SCROLL_DEBOUNCE_DELAY = 150\n\ntype Props = {\n  onScrollChanged?: (isAtBottom: boolean) => void,\n  boxRef: React.RefObject<HTMLElement | null>,\n  threshold?: number,\n  children?: any,\n}\n\nexport default ({ boxRef, onScrollChanged, threshold, children }: Props) => {\n  const [ scrollTop, setScrollTop ] = useState<number>(-1);\n  const [ height, setHeight ] = useState<number>(0);\n  const scrollDebounce = useRef<any>(null)\n\n  const onScrollDebounced = useCallback((isAtBottom: boolean) => {\n    clearTimeout(scrollDebounce.current)\n\n    if (onScrollChanged) {\n      scrollDebounce.current = setTimeout(() => {\n        onScrollChanged(isAtBottom)\n      }, SCROLL_DEBOUNCE_DELAY)\n    }\n  }, [onScrollChanged])\n\n  const scrollToBottom = useCallback(() => {\n    if (!boxRef || !boxRef.current) {\n      return\n    }\n\n    const scrollHeight = boxRef.current.scrollHeight - boxRef.current.offsetHeight\n    boxRef.current.scrollTop = scrollHeight\n\n    setScrollTop(boxRef.current.scrollTop)\n    onScrollDebounced(true)\n  }, [boxRef, onScrollDebounced, setScrollTop])\n\n  const updateScrollState = useCallback((shouldScroll: boolean) => () => {\n    if (!boxRef || !boxRef.current) {\n      return\n    }\n\n    if (scrollTop > 0) {\n      const customThreshold = threshold || SCROLL_THRESHOLD\n      if (scrollTop > 0 && Math.abs(boxRef.current.scrollTop - scrollTop) > customThreshold) {\n         // we are not at the bottom of the page, so we won't do anything\n        onScrollDebounced(false)\n        return\n      } else {\n        onScrollDebounced(true)\n      }\n    }\n\n    if (shouldScroll) {\n      scrollToBottom()\n    }\n  }, [boxRef, onScrollDebounced, threshold, scrollToBottom, scrollTop])\n\n  useEffect(() => {\n    window.addEventListener(\"resize\", scrollToBottom, true);\n\n    if (boxRef && boxRef.current) {\n      boxRef.current.addEventListener('scroll', updateScrollState(false), true)\n    }\n\n    // cleanup\n    return () => {\n      window.removeEventListener(\"resize\", scrollToBottom, true);\n    }\n  }, [boxRef, scrollToBottom, updateScrollState])\n\n  useEffect(() => {\n    // when the children changes, recalculate\n    if (!boxRef.current) {\n      return;\n    }\n    const newHeight = boxRef.current.scrollHeight;\n    if (newHeight !== height) {\n      setHeight(newHeight)\n      updateScrollState(true)()\n    }\n  }, [boxRef, height, updateScrollState, children])\n\n  return (\n    <>\n      { children }\n    </>\n  )\n}\n","import React, { useEffect, useRef, useCallback } from 'react'\nimport { Container, Button } from 'react-bootstrap'\nimport { useImmer } from 'use-immer'\nimport classNames from 'classnames'\n\nimport MessageComponent from './Message'\n\nimport styles from './index.module.scss'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport ScrollBox from './ScrollBox'\nimport useGlobalState from 'store/state'\n\ntype State = {\n  scrollAtBottom: boolean,\n  unseenMessages: boolean, // are there new messages below the scroll point?\n}\n\nexport default () => {\n  const { state } = useGlobalState()\n  const [localState, setLocalState] = useImmer<State>({\n    scrollAtBottom: true,\n    unseenMessages: false,\n  })\n\n  const chatAreaRef = useRef<HTMLDivElement>(null)\n\n  const onScrollChanged = useCallback((isAtBottom: boolean) => {\n    setLocalState(draft => {\n      draft.scrollAtBottom = isAtBottom\n      if (isAtBottom) {\n        draft.unseenMessages = false\n      }\n    })\n  }, [setLocalState])\n\n  const scrollToBottom = useCallback(() => {\n    if (!chatAreaRef || !chatAreaRef.current) {\n      return\n    }\n    const scrollHeight = chatAreaRef.current.scrollHeight - chatAreaRef.current.offsetHeight\n    chatAreaRef.current.scrollTop = scrollHeight\n\n    setLocalState(draft => {\n      draft.unseenMessages = false\n    })\n  }, [setLocalState])\n\n  useEffect(() => {\n    setLocalState(draft => {\n      draft.unseenMessages = !draft.scrollAtBottom\n    })\n  }, [state.messages, setLocalState])\n\n  // TODO set this on new messages: draft.unseenMessages = !draft.scrollAtBottom\n\n  return (\n    <div className={ styles.messages }>\n      { localState.unseenMessages && (\n        <div className={ classNames(styles.unseen) }>\n          <Container className={ styles.unseenContainer }>\n            <Button variant=\"outline-secondary\" size=\"sm\" onClick={ scrollToBottom }>\n              <FontAwesomeIcon icon='arrow-alt-circle-down' /> New messages\n            </Button>\n          </Container>\n        </div>\n      ) }\n        <div className={classNames(styles.messageScroll)} ref={chatAreaRef}>\n          <div className='container'>\n            <ScrollBox\n              boxRef={ chatAreaRef }\n              onScrollChanged={ onScrollChanged }\n            >\n              {state.messages.map((eachMessage) => (\n                <MessageComponent key={eachMessage.timestamp.getTime()} message={eachMessage} />\n              ))}\n            </ScrollBox>\n          </div>\n        </div>\n    </div>\n  )\n}\n","import React, { useContext, useRef } from 'react'\nimport { Form } from 'react-bootstrap'\nimport { useImmer } from 'use-immer'\nimport classNames from 'classnames'\n\nimport { SocketContext } from 'util/socketProvider'\nimport styles from './index.module.scss'\nimport { VALID_USERNAME } from '../../../constants'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { IconProp } from '@fortawesome/fontawesome-svg-core'\nimport useGlobalState from 'store/state'\nimport { EVENTS } from 'store/types'\n\ntype State = {\n  message: string,\n  private: boolean,\n  to: string | null,\n  isCommand: boolean,\n}\n\nexport default () => {\n  const { state } = useGlobalState();\n  const [localState, setState] = useImmer<State>({\n    message: '',\n    private: false,\n    to: null,\n    isCommand: false,\n  })\n  const draftTimer = useRef<any>(null)\n\n  const { socket } = useContext(SocketContext)\n\n  const handleSubmit = (e: React.ChangeEvent<any>) => {\n    e.preventDefault()\n\n    if (localState.message.length < 1 || localState.message.trim().length < 1) {\n      return\n    }\n\n    sendMessage(localState.message);\n\n    setState((draft) => {\n      draft.message = ''\n      draft.private = false\n      draft.isCommand = false\n    })\n  }\n\n  const sendMessage = (message: string, draft: boolean = false) => {\n    if (!draft && (message.length < 1 || message.trim().length < 1)) {\n      return\n    }\n    let type = EVENTS.MESSAGE\n    if (localState.isCommand) {\n      type = EVENTS.COMMAND\n    }\n    socket?.emit(type, {\n      message,\n      attributes: {\n        draft,\n        private: localState.private,\n        to: localState.to,\n      },\n    })\n  }\n\n  const onType = (e: React.ChangeEvent<any>) => {\n    e.preventDefault()\n\n    clearTimeout(draftTimer.current)\n\n    const value: string = e.currentTarget.value\n\n    // special messages\n    let isCommand = false;\n    let isPM = false;\n    let to: string | null = null;\n\n    if (value[0] === '/') {\n      isCommand = true;\n    } else if (value[0] === '@') {\n      const words = value.split(' ')\n      isPM = true;\n      if (words.length > 0 && words[0][0] === '@' && VALID_USERNAME.test(words[0].substr(1))) {\n        to = words[0].substr(1);\n      }\n    }\n\n    setState((draft) => {\n      draft.message = value\n      draft.private = isPM\n      draft.to = to\n      draft.isCommand = isCommand\n    })\n\n    if (isPM || isCommand) {\n      return;\n    }\n\n    if (state.draftTimer > 0) {\n      draftTimer.current = setTimeout(() => {\n        sendMessage(value, true)\n      }, state.draftTimer)\n    }\n  }\n\n  let icon: IconProp = 'lock'\n  if (localState.isCommand) {\n    icon = 'code'\n  }\n\n  return (\n    <Form noValidate onSubmit={handleSubmit} className={ classNames(styles.textBox, 'container', { [styles.private]: localState.private, [styles.command]: localState.isCommand }) }>\n      <Form.Group controlId=\"chatForm.message\">\n        <Form.Control\n          as=\"input\"\n          type=\"text\"\n          placeholder=\"Type a message...\"\n          autoFocus\n          onChange={onType}\n          value={localState.message}\n        />\n        <span>\n          <FontAwesomeIcon icon={ icon } />\n        </span>\n      </Form.Group>\n    </Form>\n  )\n}\n","import React from 'react'\nimport { IconProp, IconName } from '@fortawesome/fontawesome-svg-core'\nimport { OverlayTrigger, Tooltip } from 'react-bootstrap'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\n\nimport styles from './index.module.scss'\nimport useGlobalState from 'store/state'\n\nexport default () => {\n  const { state } = useGlobalState();\n\n  return (\n    <div className={styles.onlineUsers}>\n      {\n        state.onlineUsers.map((user) => {\n          const isCurrentUser = user.user_id === state.auth.user?.user_id\n\n          let iconName: IconName = 'circle'\n          if (user.icon) {\n            iconName = user.icon\n          } else if (user.user_id === state.auth.user?.user_id) {\n            iconName = 'dot-circle'\n          }\n\n          if (!user.isActive) {\n            iconName = 'meh'\n          }\n\n          let icon: IconProp = iconName\n          if (isCurrentUser) {\n            icon = ['far', iconName]\n          }\n\n          return (\n            <OverlayTrigger\n              key={user.user_id}\n              placement=\"bottom\"\n              overlay={<Tooltip id={`user-${user.user_id}`}>@{user.name}</Tooltip>}\n            >\n              <span style={{ color: `#${user.color}` }}>\n                <FontAwesomeIcon icon={ icon } />\n              </span>\n            </OverlayTrigger>\n          )\n        })\n      }\n    </div>\n  )\n}\n","import { useEffect, useState } from 'react'\nimport axios, { AxiosRequestConfig, AxiosError } from 'axios'\n\nimport { API_URL } from '../constants'\n\nexport type FetchMethod = 'GET' | 'POST' | 'PUT' | 'DELETE'\nexport const CSRF_HEADER = 'x-csrf-token'\nlet csrfToken = ''\n\nexport type FetchError = {\n  status: number\n  message: string\n  errors: string[]\n  data?: any\n}\n\ntype FetchReturn<T> = [boolean, T | null, FetchError | null]\n\naxios.defaults.withCredentials = true\n\nfunction useFetch<T>(\n  path: string,\n  method: FetchMethod,\n  body?: any\n): FetchReturn<T> {\n  const [error, setError] = useState<FetchError | null>(null)\n  const [loading, setLoading] = useState<boolean>(true)\n  const [response, setResponse] = useState<T | null>(null)\n\n  useEffect(() => {\n    const sendRequest = async () => {\n      try {\n        const data = await fetchResource(path, method, body)\n        setResponse(data)\n      } catch (error) {\n        setError(error)\n      } finally {\n        setLoading(false)\n      }\n    }\n\n    sendRequest()\n  }, [path, method, body])\n\n  return [loading, response, error]\n}\n\nexport const fetchResource = async (\n  path: string,\n  method: FetchMethod,\n  body?: any\n) => {\n  if (!path) {\n    throw new Error(`'url' is required for fetching data`)\n  }\n\n  const url = `${API_URL}${path}`\n  const options: AxiosRequestConfig = {\n    url,\n    method,\n    data: body,\n    timeout: 6000,\n    withCredentials: true,\n    xsrfHeaderName: CSRF_HEADER,\n    headers: {},\n  }\n\n  if (csrfToken.length > 0) {\n    options.headers[CSRF_HEADER] = csrfToken\n  }\n\n  try {\n    const response = await axios(options)\n\n    if (response.headers[CSRF_HEADER]) {\n      csrfToken = response.headers[CSRF_HEADER]\n    }\n\n    return await response.data\n  } catch (error) {\n    if (error.response) {\n      console.warn(`useFetch error on ${method} ${path}`, error.response)\n      const returnError: FetchError = {\n        status: error.response.status,\n        message: parseAxiosError(error),\n        errors: parseErrorList(error),\n        data: error.response.data\n      }\n      throw returnError\n    }\n\n    console.warn(`useFetch network error on ${method} ${path}`, error)\n    const returnError: FetchError = {\n      status: 500,\n      message: error.message,\n      errors: [error.message],\n    }\n    throw returnError\n  }\n}\n\nfunction parseAxiosError(error: AxiosError): string {\n  if (!error.response || !error.response.data) {\n    return error.message || 'An error occurred'\n  }\n\n  return parseErrorList(error).join('. ')\n}\n\nfunction parseErrorList(error: AxiosError): string[] {\n  const defaultError = 'An error occurred'\n  if (!error.response || !error.response.data) {\n    return [error.message || defaultError]\n  }\n\n  return parseErrors(\n    defaultError,\n    error.response.data,\n    error.response.data.errors,\n    error.response.data.error\n  )\n}\n\nfunction parseErrors(defaultError: string, ...errors: any[]): string[] {\n  for (let i = 0; i < errors.length; i++) {\n    const error = errors[i]\n    if (Array.isArray(error)) return error\n    if (typeof error === 'string') return [error]\n  }\n\n  return [defaultError]\n}\n\nexport default useFetch\n","import React, { useState } from 'react'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { OverlayTrigger, Tooltip, Button, Modal, Form } from 'react-bootstrap'\n\nimport styles from './index.module.scss'\nimport { fetchResource } from 'util/fetch'\nimport useGlobalState from 'store/state'\nimport { IconProp } from '@fortawesome/fontawesome-svg-core'\nimport { API_URL } from '../../../constants'\n\nexport default () => {\n  const { state, dispatch } = useGlobalState()\n\n  const [showModal, setShowModal] = useState<boolean>(false)\n  const [validated, setValidated] = useState<boolean>(false)\n\n  const [password, setPassword] = useState<string>('')\n  const [repeatPassword, setRepeatPassword] = useState<string>('')\n\n  const handleClose = () => setShowModal(false)\n  const handleShow = () => setShowModal(true)\n\n  const handleSubmit = (event: React.ChangeEvent<HTMLFormElement>) => {\n    event.preventDefault()\n    event.stopPropagation()\n\n    setValidated(true)\n\n    const form = event.currentTarget\n    if (!form.checkValidity()) {\n      return\n    }\n\n    const body = {\n      password,\n      repeatPassword,\n    }\n\n    fetchResource('/password', 'POST', body)\n      .then(() => {\n        dispatch({\n          type: 'user_password',\n          payload: true,\n        })\n\n        setShowModal(false)\n        setValidated(false)\n        setPassword('')\n        setRepeatPassword('')\n      })\n      .catch((reason) => {\n        dispatch({\n          type: 'error',\n          payload: reason.errors.join(', '),\n        })\n      })\n  }\n\n  let buttonClass = styles.unlocked\n  let buttonIcon: IconProp = 'lock-open'\n  let tooltipText = 'Set a password to keep your username'\n  let title = 'Claim Username'\n\n  if (state.auth.user && state.auth.user.hasPassword) {\n    buttonClass = styles.locked\n    buttonIcon = 'lock'\n    tooltipText = 'Change your password'\n    title = 'Update Password'\n  }\n\n  return (\n    <span className={styles.passwordLock}>\n      <OverlayTrigger\n        placement=\"bottom\"\n        delay={500}\n        overlay={<Tooltip id=\"passwordLock\">{tooltipText}</Tooltip>}\n      >\n        <Button variant=\"link\" className={buttonClass} style={ { padding: 0 } } onClick={handleShow}>\n          <FontAwesomeIcon icon={buttonIcon} />\n        </Button>\n      </OverlayTrigger>\n\n      <Modal show={showModal} onHide={handleClose}>\n        <Form noValidate validated={validated} onSubmit={handleSubmit}>\n          <Modal.Header closeButton>\n            <Modal.Title>\n              { title }\n            </Modal.Title>\n          </Modal.Header>\n\n          <Modal.Body>\n            <Form.Group controlId=\"pwd.new\">\n              <Form.Control\n                as=\"input\"\n                type=\"password\"\n                placeholder=\"Password...\"\n                autoFocus\n                required\n                minLength={6}\n                onChange={(event) => {\n                  setPassword(event.currentTarget.value)\n                }}\n                value={password}\n              />\n              <Form.Control.Feedback type=\"invalid\">\n                The password is too short. Minimum length is 6 characters.\n              </Form.Control.Feedback>\n            </Form.Group>\n\n            <Form.Group controlId=\"pwd.new\">\n              <Form.Control\n                as=\"input\"\n                type=\"password\"\n                placeholder=\"Repeat Password...\"\n                required\n                minLength={6}\n                pattern={password}\n                onChange={(event) => {\n                  setRepeatPassword(event.currentTarget.value)\n                }}\n                value={repeatPassword}\n              />\n              <Form.Control.Feedback type=\"invalid\">\n                The passwords don't match!\n              </Form.Control.Feedback>\n            </Form.Group>\n          </Modal.Body>\n          <Modal.Footer>\n            <a href={ `${API_URL}/logout` }>\n              Logout\n            </a>\n            <Button variant=\"secondary\" onClick={handleClose}>\n              Close\n            </Button>\n            <Button type=\"submit\" variant=\"primary\">\n              Set password\n            </Button>\n          </Modal.Footer>\n        </Form>\n      </Modal>\n    </span>\n  )\n}\n","import React from 'react'\nimport { Container, Row, Col } from 'react-bootstrap'\nimport { Link } from 'react-router-dom'\n\nimport { useGlobalState } from 'store/state'\nimport Loader from 'components/Loader'\n\nimport styles from './index.module.scss'\nimport Messages from './Messages'\nimport TextBox from './TextBox'\nimport OnlineUsers from './OnlineUsers'\nimport PasswordLock from './PasswordLock'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\n\nexport default () => {\n  const { state } = useGlobalState()\n\n  let chatArea = <Loader />\n\n  if (state.socket.connected) {\n    chatArea = (\n      <div className={styles.chat}>\n        <Container>\n          <Row>\n            <Col>\n              <PasswordLock />\n              { state.auth.user?.isAdmin && (\n                <Link to='/admin' title='Monitoring' style={ { marginLeft: '1em' } }>\n                  <FontAwesomeIcon icon='shield-alt' />\n                </Link>\n              ) }\n            </Col>\n            <Col>\n              <OnlineUsers />\n            </Col>\n          </Row>\n        </Container>\n\n        <Messages />\n        <TextBox />\n      </div>\n    )\n  }\n\n  return chatArea\n}\n","import React from 'react'\n\nimport Loader from 'components/Loader'\n\nexport default () => {\n  return (\n    <>\n      <Loader />\n    </>\n  )\n}\n","import React from 'react'\nimport { Route, Redirect } from 'react-router-dom'\nimport { useGlobalState } from 'store/state'\n\nimport Loading from 'sections/loading'\n\ntype Props = {\n  path: string\n  exact?: boolean\n  component?: React.ComponentType<any>\n}\n\n/**\n * This Route only allows browsing into if the user IS logged in\n */\nexport default (props: Props) => {\n  const { state } = useGlobalState()\n  if (!state.auth.checked) {\n    return <Loading />\n  }\n\n  if (!state.auth.loggedIn) {\n    return <Redirect to=\"/login\" />\n  }\n\n  return (\n    <Route path={props.path} exact={props.exact} component={props.component} />\n  )\n}\n","import React from 'react'\nimport { Route, Redirect } from 'react-router-dom'\nimport { useGlobalState } from 'store/state'\n\nimport Loading from 'sections/loading'\n\ntype Props = {\n  path: string\n  exact?: boolean\n  component?: React.ComponentType<any>\n}\n\n/**\n * This Route only allows browsing into if the user is NOT logged in\n */\nexport default (props: Props) => {\n  const { state } = useGlobalState()\n  if (!state.auth.checked) {\n    return <Loading />\n  }\n\n  if (state.auth.loggedIn) {\n    return <Redirect to=\"/\" />\n  }\n\n  return (\n    <Route path={props.path} exact={props.exact} component={props.component} />\n  )\n}\n","import React from 'react'\n\nimport { useGlobalState } from 'store/state'\nimport styles from './index.module.scss'\n\nexport default () => {\n  const { state } = useGlobalState()\n\n  if (!state.offline && !state.error) {\n    return null\n  }\n\n  let error = state.error\n  if (Array.isArray(error)) {\n    error = error.join('. ')\n  }\n  if (typeof error !== 'string') {\n    error = String(error)\n  }\n\n  if (state.error) {\n    return <div className={styles.offline}>Error: {error}</div>\n  }\n\n  return (\n    <div className={styles.offline}>\n      You seem to be offline! Please try again later\n    </div>\n  )\n}\n","import React, { useRef } from 'react'\nimport { Form, Container } from 'react-bootstrap'\nimport { useImmer } from 'use-immer'\nimport classNames from 'classnames'\nimport HCaptcha from \"react-hcaptcha\"\n\nimport { useGlobalState } from 'store/state'\nimport { fetchResource } from 'util/fetch'\nimport Logo from 'components/Logo'\n\nimport styles from './index.module.scss'\nimport { AuthData } from 'store/types'\nimport { CAPTCHA_KEY } from '../../constants'\n\ntype State = {\n  username: string\n  password: string\n  verified: boolean\n  hasPassword: boolean\n  loading: boolean\n}\n\nexport default () => {\n  const { dispatch } = useGlobalState()\n  const [localState, setState] = useImmer<State>({\n    username: '',\n    password: '',\n    verified: false,\n    hasPassword: false,\n    loading: false,\n  })\n\n  const captchaRef = useRef<any>(null)\n\n  const handleSubmit = (e: React.ChangeEvent<any>) => {\n    e.preventDefault()\n    if (localState.verified) {\n      oncaptchaChange('verified')\n      return\n    }\n    captchaRef.current.execute()\n  };\n\n  const oncaptchaChange = (token: string | null) => {\n    if (!token || localState.loading) {\n      return\n    }\n\n    setState((draft) => {\n      draft.loading = true\n    })\n\n    const body = {\n      username: localState.username,\n      password: localState.password,\n      captchaToken: token,\n    }\n    fetchResource('/auth', 'POST', body)\n      .then((data: AuthData) => {\n        if (!data || !data.user.user_id) {\n          console.warn('Invalid user object')\n          dispatch({\n            type: 'login',\n            payload: data,\n          })\n          return\n        }\n\n        dispatch({\n          type: 'login',\n          payload: data,\n        })\n      })\n      .catch((reason) => {\n        if (reason.status !== 400) {\n          // username requires password\n          dispatch({\n            type: 'error',\n            payload: reason.errors.join(', '),\n          })\n        }\n\n        if (captchaRef.current.resetCaptcha) {\n          captchaRef.current.resetCaptcha()\n        }\n\n        setState((draft) => {\n          draft.loading = false\n          draft.verified = (reason.data && reason.data.verified) || false\n          if (reason.status === 400) {\n            draft.hasPassword = true\n          }\n        })\n      }\n    )\n  }\n\n  let theme = 'light'\n  if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {\n    theme = 'dark'\n  }\n\n  return (\n    <Container className={classNames(styles.login, 'mt-4')}>\n      <Logo />\n      <Form noValidate onSubmit={handleSubmit}>\n        <Form.Group controlId=\"loginForm.username\">\n          <Form.Control\n            as=\"input\"\n            type=\"text\"\n            placeholder=\"What's your name?\"\n            disabled={localState.loading}\n            autoFocus\n            minLength={ 1 }\n            maxLength={ 20 }\n            onChange={(e) => {\n              const value = e.currentTarget.value\n              setState((draft) => {\n                draft.username = value\n              })\n            }}\n            value={localState.username}\n          />\n          {localState.hasPassword && (\n            <Form.Control\n              as=\"input\"\n              className=\"mt-2\"\n              type=\"password\"\n              placeholder=\"Password...\"\n              disabled={localState.loading}\n              autoFocus\n              onChange={(e) => {\n                const value = e.currentTarget.value\n                setState((draft) => {\n                  draft.password = value\n                })\n              }}\n              value={localState.password}\n            />\n          )}\n          <HCaptcha\n            ref={ captchaRef }\n            size='invisible'\n            theme={ theme }\n            sitekey={ CAPTCHA_KEY }\n            onVerify={ oncaptchaChange }\n          />\n          <button type=\"submit\" style={{ visibility: 'hidden' }}>\n            Login\n          </button>\n        </Form.Group>\n      </Form>\n    </Container>\n  )\n}\n","import { Action, AuthData } from 'store/types'\n\nimport { fetchResource } from './fetch'\n\nconst OFFLINE_RETRY_DELAY = 2000\n\nexport const checkAuth = (dispatch: React.Dispatch<Action>) => {\n  fetchResource('/auth', 'GET')\n    .then((data: AuthData) => {\n      if (!data || !data.user.user_id) {\n        console.warn('Invalid user object')\n        dispatch({\n          type: 'login',\n          payload: null,\n        })\n        return\n      }\n\n      dispatch({\n        type: 'login',\n        payload: data,\n      })\n    })\n    .catch((reason) => {\n      if (reason.message === 'Network Error') {\n        dispatch({\n          type: 'offline',\n          payload: null,\n        })\n\n        // try again\n        setTimeout(() => {\n          checkAuth(dispatch)\n        }, OFFLINE_RETRY_DELAY)\n      } else {\n        if (reason.status !== 401) {\n          dispatch({\n            type: 'error',\n            payload: reason.errors.join(', '),\n          })\n        }\n\n        dispatch({\n          type: 'login',\n          payload: null,\n        })\n      }\n    })\n}\n\nexport default checkAuth\n","import React, { useEffect } from 'react'\nimport { Switch } from 'react-router-dom'\n\nimport Chat from 'sections/Chat'\nimport AuthenticatedRoute from 'util/AuthenticatedRoute'\nimport UnauthenticatedRoute from 'util/UnauthenticatedRoute'\nimport OfflineCheck from 'components/OfflineCheck'\nimport Login from 'sections/Login'\nimport useGlobalState from 'store/state'\nimport checkAuth from 'util/checkAuth'\nimport Admin from 'sections/Admin'\n\nexport default () => {\n  const { state, dispatch } = useGlobalState()\n\n  // Check authentication state\n  useEffect(() => {\n    if (!state.auth.checked) {\n      checkAuth(dispatch)\n    }\n  }, [state.auth.checked, dispatch])\n\n  return (\n    <>\n      <OfflineCheck />\n      <Switch>\n        <UnauthenticatedRoute path=\"/login\" component={Login} />\n        <AuthenticatedRoute path=\"/admin\" component={Admin} />\n        <AuthenticatedRoute path=\"/\" component={Chat} />\n      </Switch>\n    </>\n  )\n}\n","import React, { useEffect, useContext, useCallback } from 'react'\nimport Helmet from 'react-helmet'\nimport useSound from 'use-sound'\nimport { useImmer } from 'use-immer'\n\nimport { SocketContext } from 'util/socketProvider'\nimport { Message } from 'store/types'\nimport useGlobalState from 'store/state'\nimport newMessageSound from 'assets/sounds/newMessage.mp3'\nimport { dateDiff } from 'lib/dateDiff'\n\nconst TIME_BETWEEN_SOUND = 5 * 1000 // ms\nconst NOTIFICATION_VOLUME = 0.5 // 0-1\n\ntype State = {\n  lastSound: Date | null,\n  windowFocused: boolean,\n  titleNotification: boolean,\n}\n\nexport default () => {\n  const { state } = useGlobalState();\n  const [ localState, setState ] = useImmer<State>({\n    lastSound: new Date(),\n    windowFocused: true,\n    titleNotification: false,\n  })\n\n  const { socket } = useContext(SocketContext)\n  const [ play ] = useSound(newMessageSound, {\n    interrupt: true,\n    volume: NOTIFICATION_VOLUME,\n  });\n\n  const onMessage = useCallback((user_id: string) => (msg: Message) => {\n    if (msg.attributes.draft || user_id === msg.user.user_id) {\n      return\n    }\n\n    setState(draft => {\n      if (!draft.windowFocused) {\n        draft.titleNotification = true;\n\n        if (!draft.lastSound || dateDiff(draft.lastSound) > TIME_BETWEEN_SOUND) {\n          draft.lastSound = new Date()\n          play({})\n        }\n      }\n    })\n  }, [setState, play])\n\n  const onFocus = useCallback(() => {\n    setState(draft => {\n      draft.titleNotification = false\n      draft.windowFocused = true\n    })\n  }, [setState])\n\n  const onBlur = useCallback(() => {\n    setState(draft => {\n      draft.windowFocused = false\n    })\n  }, [setState])\n\n  const user_id = state.auth.user ? state.auth.user.user_id : null\n\n  useEffect(() => {\n    if (!socket || !user_id) {\n      return\n    }\n    socket.on('message', onMessage(user_id))\n  }, [socket, onMessage, user_id])\n\n  useEffect(() => {\n    window.addEventListener('focus', onFocus)\n    window.addEventListener('blur', onBlur)\n\n    return () => {\n      window.removeEventListener('focus', onFocus)\n      window.removeEventListener('blur', onBlur)\n    }\n  }, [onFocus, onBlur])\n\n  return (\n    <Helmet>\n      <title>{localState.titleNotification ? '•• dotdot' : 'dotdot'}</title>\n    </Helmet>\n  )\n}\n","/**\n * Get the difference between two date objects in ms\n */\nexport const dateDiff = (t1: Date, t2: Date = new Date()) => {\n  return t2.getTime() - t1.getTime();\n};","import { library } from '@fortawesome/fontawesome-svg-core'\n\n/**\n * Icon Preloading\n * This is done so that only the icons that we need are loaded from FontAwesome\n */\n\n// Icons available in two styles, regular and solid\n// solid tends to have all free icons, while some regular ones are PRO only\nimport {\n  faLock,\n  faLockOpen,\n  faCircle,\n  faDotCircle,\n  faCircleNotch,\n  faCode,\n  faCog,\n  faArrowAltCircleDown,\n  faMeh,\n  faAngry,\n  faDizzy,\n  faFlushed,\n  faFrown,\n  faFrownOpen,\n  faGrimace,\n  faGrin,\n  faGrinAlt,\n  faGrinBeam,\n  faGrinBeamSweat,\n  faGrinHearts,\n  faGrinSquint,\n  faGrinSquintTears,\n  faGrinStars,\n  faGrinTears,\n  faGrinTongue,\n  faGrinTongueSquint,\n  faGrinTongueWink,\n  faGrinWink,\n  faKiss,\n  faKissBeam,\n  faKissWinkHeart,\n  faLaugh,\n  faLaughBeam,\n  faLaughSquint,\n  faLaughWink,\n  faMehBlank,\n  faMehRollingEyes,\n  faSadCry,\n  faSadTear,\n  faSmile,\n  faSmileBeam,\n  faSmileWink,\n  faSurprise,\n  faTired,\n  faShieldAlt,\n} from '@fortawesome/free-solid-svg-icons'\n\nimport {\n  faDotCircle as farDotCircle,\n  faMeh as farMeh,\n  faAngry as farAngry,\n  faDizzy as farDizzy,\n  faFlushed as farFlushed,\n  faFrown as farFrown,\n  faFrownOpen as farFrownOpen,\n  faGrimace as farGrimace,\n  faGrin as farGrin,\n  faGrinAlt as farGrinAlt,\n  faGrinBeam as farGrinBeam,\n  faGrinBeamSweat as farGrinBeamSweat,\n  faGrinHearts as farGrinHearts,\n  faGrinSquint as farGrinSquint,\n  faGrinSquintTears as farGrinSquintTears,\n  faGrinStars as farGrinStars,\n  faGrinTears as farGrinTears,\n  faGrinTongue as farGrinTongue,\n  faGrinTongueSquint as farGrinTongueSquint,\n  faGrinTongueWink as farGrinTongueWink,\n  faGrinWink as farGrinWink,\n  faKiss as farKiss,\n  faKissBeam as farKissBeam,\n  faKissWinkHeart as farKissWinkHeart,\n  faLaugh as farLaugh,\n  faLaughBeam as farLaughBeam,\n  faLaughSquint as farLaughSquint,\n  faLaughWink as farLaughWink,\n  faMehBlank as farMehBlank,\n  faMehRollingEyes as farMehRollingEyes,\n  faSadCry as farSadCry,\n  faSadTear as farSadTear,\n  faSmile as farSmile,\n  faSmileBeam as farSmileBeam,\n  faSmileWink as farSmileWink,\n  faSurprise as farSurprise,\n  faTired as farTired,\n} from '@fortawesome/free-regular-svg-icons'\n\n/**\n * All icons that will be used in this app need to be preloaded here\n */\nlibrary.add(\n  faLock,\n  faLockOpen,\n  faCircle,\n  faDotCircle,\n  farDotCircle,\n  faCircleNotch,\n  faCode,\n  faCog,\n  faArrowAltCircleDown,\n  faMeh,\n  farMeh,\n  faAngry,\n  faDizzy,\n  faFlushed,\n  faFrown,\n  faFrownOpen,\n  faGrimace,\n  faGrin,\n  faGrinAlt,\n  faGrinBeam,\n  faGrinBeamSweat,\n  faGrinHearts,\n  faGrinSquint,\n  faGrinSquintTears,\n  faGrinStars,\n  faGrinTears,\n  faGrinTongue,\n  faGrinTongueSquint,\n  faGrinTongueWink,\n  faGrinWink,\n  faKiss,\n  faKissBeam,\n  faKissWinkHeart,\n  faLaugh,\n  faLaughBeam,\n  faLaughSquint,\n  faLaughWink,\n  faMehBlank,\n  faMehRollingEyes,\n  faSadCry,\n  faSadTear,\n  faSmile,\n  faSmileBeam,\n  faSmileWink,\n  faSurprise,\n  faTired,\n  farAngry,\n  farDizzy,\n  farFlushed,\n  farFrown,\n  farFrownOpen,\n  farGrimace,\n  farGrin,\n  farGrinAlt,\n  farGrinBeam,\n  farGrinBeamSweat,\n  farGrinHearts,\n  farGrinSquint,\n  farGrinSquintTears,\n  farGrinStars,\n  farGrinTears,\n  farGrinTongue,\n  farGrinTongueSquint,\n  farGrinTongueWink,\n  farGrinWink,\n  farKiss,\n  farKissBeam,\n  farKissWinkHeart,\n  farLaugh,\n  farLaughBeam,\n  farLaughSquint,\n  farLaughWink,\n  farMehBlank,\n  farMehRollingEyes,\n  farSadCry,\n  farSadTear,\n  farSmile,\n  farSmileBeam,\n  farSmileWink,\n  farSurprise,\n  farTired,\n  faShieldAlt,\n)\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { BrowserRouter } from 'react-router-dom'\n\nimport { StateProvider } from 'store/state'\nimport SocketProvider from 'util/socketProvider'\n\nimport Router from './router'\nimport Title from './components/Title'\n\nimport './lib/icons'\nimport 'assets/scss/index.scss'\n\n\nconst app = (\n  <BrowserRouter basename={process.env.REACT_APP_BASEPATH}>\n    <StateProvider>\n      <SocketProvider>\n        <Title />\n        <Router />\n      </SocketProvider>\n    </StateProvider>\n  </BrowserRouter>\n)\n\nReactDOM.render(app, document.getElementById('root'))\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"logo\":\"Logo_logo__30xDu\",\"svgFilter\":\"Logo_svgFilter__1s9i7\",\"blob\":\"Logo_blob__1iSwo\",\"blob-first\":\"Logo_blob-first__3YKrD\",\"blob-second\":\"Logo_blob-second__2r5Nx\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"messages\":\"Messages_messages__tCmp1\",\"messageScroll\":\"Messages_messageScroll__CCnSp\",\"unseen\":\"Messages_unseen__gVw6f\",\"unseenContainer\":\"Messages_unseenContainer__3haBw\"};"],"sourceRoot":""}